\appendix

# Socio-demographic metrics for each electorate {#a:describeSD}

ID: Commonwealth Electoral Division (Census division) number

Electorate: Name of Commonwealth Electoral Division

State: State of Census division

Population: Count of persons in Census division

**Age**

Age0004: Percentage of population aged 0-4 years

Age0514: Percentage of population aged 5-14 years

Age1519: Percentage of population aged 15-19 years

Age2024: Percentage of population aged 20-24 years

Age2534: Percentage of population aged 25-34 years

Age3544: Percentage of population aged 35-44 years

Age4554: Percentage of population aged 45-54 years

Age5564: Percentage of population aged 55-64 years

Age6574: Percentage of population aged 65-74 years

Age7584: Percentage of population aged 75-84 years

Age85plus: Percentage of population aged 85+ years

**Median Statistics**

MedianPersonalIncome: Median weekly personal income

MedianHouseholdIncome: Median weekly household income

MedianFamilyIncome: Median weekly family income

MedianAge: Median age

MedianRent: Median weekly rental payment amount (of those who rent)

MedianLoanPay: Median mortgage loan repayment amount (of mortgage payments)

**Religion**

Christianity: Percentage of respondents that identified as Christian (excluding overseas visitors)

Anglican: Percentage of respondents that identified as Anglican (excluding overseas visitors)

Catholic: Percentage of respondents that identified as Catholic (excluding overseas visitors)

Buddhism: Percentage of respondents that identified as Buddhist (excluding overseas visitors)

Islam: Percentage of respondents that identified as Muslim (excluding overseas visitors)

Judaism: Percentage of respondents that identified as Jewish (excluding overseas visitors)

NoReligion: Percentage of respondents that identified as "no religion", "atheist" etc. (excluding overseas visitors)

OtherChrist: Percentage of respondents that identified as Christian, but not Anglican or Catholic (excluding overseas visitors)

**Language, Heritage, Birthplace and Citizenship**

Indigenous: Percentage of population that identify as Indigenous or Torres Strait Islander

AusCitizen: Percentage of population who are Australian Citizens

BornAsia: Percentage of respondents born in Asia (includes: Bangladesh, Cambodia, China, Hong Kong, Indonesia, Japan, South Korea, Malaysia, Nepal, Pakistan, Phillipines, Singapore, Sri Lanka, Thailand, Taiwan, Vietnam)

BornMidEast: Percentage of respondents born in Middle East (includes: Afghanistan, Egypt, Iran, Lebanon, Turkey)

BornSEEurope: Percentage of respondents born in South-East Europe (includes: Bosnia and Herzegovina, Croatia, Greece, Macedonia, other South-East Europe)

BornUK: Percentage of respondents born in the United Kingdom (includes: England, Wales, Scotland, Northern Ireland)

BornElsewhere: Percentage of respondents born overseas in regions over Asia, Middle East, South-East Europe and UK  (includes overseas visitors)

OtherLanguageHome: Percentage of respondents that speak other languages other than English at home

**Education**

CurrentlyStudying: Percentage of population that are currently studying

HighSchool: Percentage of respondents (15 years and over) that have finished High School

Bachelor: Percentage of respondents (15 years and over) that have completed a Bachelors degree

Postgraduate: Percentage of respondents (15 years and over) that have completed a Postgraduate degree

DipCert: Percentage of respondents (15 years and over) that have completed a diploma or certificate

Note: respondents is calculated by taking population 15 years and over, less question non-responses

**Employment**

Unemployed: Unemployment rate (percentage)

LFParticipation: Labour force participation rate (percentage)

Volunteer: Percentage of respondents (15 years and over) that do volunteer work [2006, 2011, 2016]

**Industry of Employment**

ExtractiveJobs: Percentage of employed persons (respondents) who work in agriculture, mining, electricity, gas, water or waste

Transformative: Percentage of employed persons (respondents) who work in construction or manufacturing

Distributive: Percentage of employed persons (respondents) who work in wholesale trade, retail trade, transport, post or warehousing

Finance: Percentage of employed persons (respondents) who work in finance or insurance

SocialServ: Percentage of employed persons (respondents) who work in education and training, healthcare, social work, community, arts and recreation

**Occupation Groups**

AdminJobs: Percentage of employed persons (respondents) who work in management, administration, clerical duties and sales

Professional: Percentage of employed persons (respondents) who work as a professional

Tradesperson: Percentage of employed persons (respondents) who specialise in a trade

Laborer: Percentage of employed persons (respondents) who work as a laborer

**Family and Relationship**

Married: Percentage of people that are married (excluding overseas visitors, including not stated)

DeFacto: Percentage of people that are in a De Facto relationship (excluding overseas visitors, including not stated)

FamilyRatio: Ratio of people in families to the number of total families (ie. average number of people per family)

CoupleNoChildHouse: Percentage of households that are made up of an adult couple with no children

CoupleWChildHouse: Percentage of households that are made up of an adult couple with children

OneParentHouse: Percentage of households that are made up of a single parent with children

SPHouse: Percentage of households that are made up of a single person

**Dwelling**

Owned: Percentage of dwellings that are owned outright (of respondents)

Mortgage: Percentage of dwellings that are on a mortgage (of respondents)

Renting: Percentage of dwellings that are being rented (of respondents)

PublicHousing: Percentage of dwellings that are owned by the government, and rented out to tenants (of respondents)

NotOwned: Percentage of dwellings (respondents only) that are not owned outright or on a mortgage

DiffAddress: Percentage of respondents who live at a different address to what they did 5 years prior




# Summary of variables in each election {#a:summary}

As seen in Chapter \@ref(ch:Data), violin plots are used to depict the distributions of socio-demographic variables across years. Violin plots depict the distribution as a density plot reflected in the vertical axis. Figures \@ref(fig:violinall1) and \@ref(fig:violinall2) (below) contain violin plots of every socio-demographic variable. Note that these variables have not been standardised.

```{r violinall1, fig.height=10, fig.cap = "Distribution of each socio-demographic variable across elections (part 1)."}
# Unscaled violin plots go here
 violins <- profiles %>% 
  select(-c(Election_Division, Swing, Perc_LNP, PartyAb))

violins %>% 
  select(unlist((violins %>% names)[order(violins %>% names)][1:36]), year) %>%
  gather(key = "metric", value = "value", -year) %>%
  ggplot(aes(x=year, y=value)) +
  geom_violin(aes(fill = year)) + 
  facet_wrap(~metric, scales = "free_y", ncol = 4) +
  theme(axis.text.y = element_text(size = 6), axis.text.x = element_text(angle = 90, hjust = 0.5, size = 6), 
        strip.text = element_text(size=6), aspect.ratio = 0.5) +
  guides(fill = FALSE) +
  labs(x = "", y = "")
```

```{r violinall2, fig.height=10, fig.cap = "Distribution of each socio-demographic variable across elections (part 2)."}
# Unscaled violin 2 plots go here
violins %>% 
  select(unlist((violins %>% names)[order(violins %>% names)][37:64])) %>%
  gather(key = "metric", value = "value", -year) %>%
  ggplot(aes(x=year, y=value)) +
  geom_violin(aes(fill = year)) + 
  facet_wrap(~metric, scales = "free_y", ncol = 4) +
  theme(axis.text.y = element_text(size = 6), axis.text.x = element_text(angle = 90, hjust = 0.5, size = 6), 
        strip.text = element_text(size=6), aspect.ratio = 0.5) +
  guides(fill = FALSE) +
  labs(x = "", y = "")
```




```{r scex, fig.cap = "Distribution of unscaled variables (including factors) excluded from the models.", include = FALSE}
# Standardized violin plots go here
data_mod %>% 
  select(-c((superset$varname %>% unlist), Election_Division, Swing, Perc_LNP)) %>% 
  gather(key = "metric", value = "value", -year) %>% 
  ggplot(aes(x=year, y=value)) +
  geom_violin(aes(fill = year)) + 
  facet_wrap(~metric, scales = "free", ncol = 6) +
  theme(axis.text.y = element_text(size = 6), axis.text.x = element_text(angle = 90, hjust = 0.5, size = 6), axis.title = element_text(size = 6), strip.text = element_text(size=5)) +
  guides(fill = FALSE) +
  labs(x = "", y = "")
```




# Principal components {#a:PCloadings}

Loadings in the 2nd, 3rd and 4th principal components for each election.

```{r loadings2, fig.cap = "Loadings of each variable in the second principal of each election year (points), with a line showing the range across years."}
vis_loadings %>% 
  ggplot(aes(x=reorder(metric,-PC2), y=PC2)) + geom_line(col = "orange", size = 2, alpha = 0.7) +
  geom_point(size = 1, alpha = 1) + 
  theme(axis.text.x = element_text(angle = 60, hjust=1, size = 6)) +
  labs(x = "Socio-demographic variable", y = "Loading in first principal component")

```

```{r loadings3, fig.cap = "Loadings of each variable in the third principal of each election year (points), with a line showing the range across years."}
vis_loadings %>% 
  ggplot(aes(x=reorder(metric,-PC3), y=PC3)) + geom_line(col = "purple", size = 2, alpha = 0.4) +
  geom_point(size = 1, alpha = 1) + 
  theme(axis.text.x = element_text(angle = 60, hjust=1, size = 6)) +
  labs(x = "Socio-demographic variable", y = "Loading in first principal component")
```

```{r loadings4, fig.cap = "Loadings of each variable in the fourth principal of each election year (points), with a line showing the range across years."}
vis_loadings %>% 
  ggplot(aes(x=reorder(metric,-PC4), y=PC4)) + geom_line(col = "dark green", size = 2, alpha = 0.5) +
  geom_point(size = 1, alpha = 1) + 
  theme(axis.text.x = element_text(angle = 60, hjust=1, size = 6)) +
  labs(x = "Socio-demographic variable", y = "Loading in first principal component")
```





# Why choose all five variable linear models? {#a:fivevar}

For each election, we compute all possible five variable linear models as a model set from which Akaike weights will be computed. *Five* variable models are a compromise between computational burden and capturing sufficient information in the model set. 

It is too burdensome to run linear models for all possible combinations of our predictors. Instead an iterative procedure is employed to sample from the possible linear models, of all sizes. This is done to see where how the incremental gain in R-squared from adding a variable reduces as the number of predictors increases. This is done by fitting 20 models for each number of predictors. This means 20 models with 2 variables, 20 models with 3 variables and so on. The process is as follows:

1. Fit all possible 2 variable models.

2. Retain the 10 models with highest R-squared, and another 10 models selected at random.

3. Fit all possible three variable models that nest these 20 two-variable models, by adding one variable. This means for every retained model, there will be $30 - 2 = 28$ models fit.

4. Repeat steps 2 and 3 for the 3 variable models, 4 variable models, and so on, until reaching a model with all 30 variables.

Figure \@ref(fig:tradeoff) shows the R-squared for each of the models retained, with the number of predictors on the x-axis, and R-squared on the y-axis. The line represents the maximum R-squared each number of predictors. We see that around 70% of variation in two-party preference can be explained by a five variable model in each election, and the full variable set explains around 80% of variation (i.e. R-squared of 0.8). From variable 4 onwards, there is little incremental gain in R-squared from adding another variable.

All possible $p$ variable models for each election involves fitting ${30 \choose p} \times 6$ models. The computational burden here becomes huge very quickly. For this reason, we have chosen $p=5$ variable models, as it is computationally feasible and as demonstrated, it can still includes models that have large R-squared.

```{r tradeoff, fig.cap = "R-squared for each model, with the number of variables included on the x-axis."}
load("../Modelling-Elections/Clean-Data/step_all.rda")

ggplot(aes(x = num_vars, y = r2), data = step_all) + 
  geom_point(alpha = 0.3) +
  geom_line(data = step_all %>% filter(max_r2 == 1)) +
  facet_wrap(~year) +
  labs(x = "Number of variables", y = "R-squared")
```

# Resultant Akaike weights {#a:allSAW}

The sum of Akaike weights $s_j$ for each variable $j$ in each of the elections is shown in the table \@ref(fig:allSAW) below.

```{r allSAW, fig.cap = "Sum of Akaike weights for each variable, in each election.", results = 'asis'}
load("../Modelling-Elections/Clean-Data/var_imp_all.rda")

tab_aw <- var_imp_all %>% 
  select(varname, year, sum_w) %>% 
  spread("year", "sum_w") %>% 
  rename(Variable = varname) %>% 
  xtable::xtable(caption = "Sum of Akaike weights for each variable, in each election.")

print(tab_aw, comment = FALSE, include.rownames = FALSE)
```


# Scatterplots of two-party preferred against predictors in the superset {#a:scatterplots}

```{r rawSE, fig.cap="Scatterplot of population born in South-Eastern Europe against two-party preferred vote."}
## Voting against BornSEEurope
data_mod %>% ggplot(aes(x = BornSEEurope, y = Perc_LNP)) + geom_point() + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Population born in South-Eastern Europe", y = "Two-party preferred (%)")
```

```{r rawUK, fig.cap="Scatterplot of population born in the United Kingdom against two-party preferred vote."}
## Voting against BornUK
data_mod %>% ggplot(aes(x = BornUK, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Population born in the United Kingdom", y = "Two-party preferred (%)")
```


```{r rawNoRelig, fig.cap="Scatterplot of population not identifying with a religion against two-party preferred vote."}
## Voting against NoReligion
data_mod %>% ggplot(aes(x = NoReligion, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Proportion of population not identifying with a religion", y = "Two-party preferred (%)")
```


```{r rawrentloan, fig.cap="Scatterplot of rental and loan payments against two-party preferred vote."}
## Voting against RentLoan
data_mod %>% ggplot(aes(x = RentLoan, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Rental and loan payments", y = "Two-party preferred (%)")
```


```{r raweduc, fig.cap="Scatterplot of education levels against two-party preferred vote."}
## Voting against Education
data_mod %>% ggplot(aes(x = Education, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Education level", y = "Two-party preferred (%)")
```


```{r rawage, fig.cap="Scatterplot of median age against two-party preferred vote."}
## Voting against MedianAge
data_mod %>% ggplot(aes(x = MedianAge, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Median age", y = "Two-party preferred (%)")
```


```{r rawOP, fig.cap = "Scatterplot of single parent households against two-party preferred vote."}
## Voting against OneParentHouse
data_mod %>% ggplot(aes(x = OneParentHouse, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Proportion of single parent households", y = "Two-party preferred (%)")
```


```{r, fig.cap="Scatterplot of population working in ExtractiveJobs jobs against two-party preferred vote."}
## Voting against ExtractiveJobs
data_mod %>% ggplot(aes(x = ExtractiveJobs, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Jobs in ExtractiveJobs industries", y = "Two-party preferred (%)")
```


```{r, fig.cap="Scatterplot of population working in administrative jobs against two-party preferred vote."}
## Voting against AdminJobs
data_mod %>% ggplot(aes(x = AdminJobs, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Administrative jobs", y = "Two-party preferred (%)")
```



# Diagnostics {#a:diagnostics}

## Residuals

```{r augment}
aug_all <- bind_rows(augment(fit_ss_01) %>% mutate(year = "2001"), 
                     augment(fit_ss_04) %>% mutate(year = "2004"), 
                     augment(fit_ss_07) %>% mutate(year = "2007"), 
                     augment(fit_ss_10) %>% mutate(year = "2010"), 
                     augment(fit_ss_13) %>% mutate(year = "2013"), 
                     augment(fit_ss_16) %>% mutate(year = "2016"))
```

There are is little evidence of residual non-normality in the histograms and quantile-quantile plots, nor are there signs of residual heteroskedasticity (figures in \@ref(fig:alldiagnostics)). We produced plots of residuals against predictors in the model, which did not reveal any significant non-linear relationships. Doing the same for residuals against predictors excluded from the model, we do not find evidence of significant relationships between omitted socio-demographics and the residuals (see appendix D). All of this validates our assumptions about the distribution of the errors, and our model specification.

```{r alldiagnostics, fig.cap = "Diagnostics plots. Left are the histograms of the residuals in each year. Middle are the quantile-quantile plots. Right are the residuals against fitted values."}
# Histogram
d1 <- aug_all %>% 
  ggplot(aes(x = .resid)) + 
  geom_histogram() +
  facet_wrap(~year, nrow = 6) + 
  labs(x = "Residuals", y = "Count", title = "Residual histograms") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

# QQ plots
d2 <- aug_all %>% 
  ggplot(aes(sample = .resid)) + 
  geom_qq(alpha = 0.4) + geom_qq_line() + 
  facet_wrap(~year, nrow = 6) +
  labs(x = "Theoretical quantiles", y = "Sample residual quantiles", title = "Residual quantile-quantile plots") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

# Residuals vs fitted
d3 <- aug_all %>% 
  ggplot(aes(x=.fitted, y=.resid)) + 
  geom_point() + geom_smooth() +
  facet_wrap(~year, nrow = 6) + 
  labs(x = "Fitted values", y = "Residuals", title = "Residuals against fitted values") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

grid.arrange(d1,d2,d3, nrow = 1)
```

## Influence

Across the six elections, only two electorates have moderately large influence - Kalgoorlie (2001, 2004) and Sydney (2007, 2016) - as they have cook's distance greater than 0.2. The Kalgoorlie electorate supports the Liberal party  in these years ($TPP$ of around 55), but has an extremely low incidence of administrative jobs and a high incidence of atheism which are strong factors of Labor support. Sydney is a staunch Labor electorate, with $TPP$ ranging from 30.50% to 35.35% across the six years, but has very large student populations, low incidence of single parent households and high rental/loan prices. All of the observations with moderately large influence have hat values over 0.3, indicating that these also have unusual socio-demographic compositions.

The most influential electorate is Kalgoorlie in 2001, with cook distance of 0.31. As this is not particularly high, it does not appear that there are any outliers that have high influence on the model, and hence no observations should be removed. 


## Non-linearities: Residuals against predictors
```{r, out.width="100%", fig.cap = "Residuals vs. predictors in the model. No signs of non-linearity."}
aug_all %>%
  filter(year == "2016") %>% 
  gather(key = "variable", value = "value", -c(starts_with("."), Perc_LNP, year)) %>% 
  ggplot(aes(x = value, y = .resid)) +
  geom_point() + geom_smooth() + facet_wrap(~variable, scales = "free_x")
```

No obvious non-linearities in 2001, 2004, 2007, 2010, 2013, 2016.

## Residuals vs Predictors not in model
```{r, out.width="100%", fig.cap = "Residuals vs. predictors in the model. No clear ."}
vars_not_in <- names(data_mod)[which(!names(data_mod) %in% superset$varname)]

aug_all %>% bind_cols(data_mod %>% filter(!is.na(Perc_LNP))) %>% 
  filter(year == "2013") %>% 
  select(starts_with("."), c(vars_not_in), -c(Swing, year, Election_Division)) %>% 
  gather(key = "variable", value = "value", -c(starts_with("."), Perc_LNP)) %>%
  ggplot(aes(x = value, y = .resid)) +
  geom_point() + geom_smooth(level = 0.95) + facet_wrap(~variable, scales = "free")
```

No obvious patterns in the residuals vs omitted variables.

# Omitted variables {#a:omittedvar}

We linearly regress each omitted variable against the superset of predictors, and record the R-squared values in each election.

```{r ovb, fig.cap = "R-squared of each omitted variable when regressed on the superset each year."}
OVB_fn <- function(Year) {
  Year <- as.character(Year)
  
OVB_lm <- data.frame(varname = names(data_mod), r2 = 0, adj_r2 = 0) %>% 
  filter(!varname %in% c("Election_Division", "Perc_LNP", "Swing", "year", superset$varname %>% unlist %>% as.character))

for (i in 1:nrow(OVB_lm)) {
  varname = OVB_lm$varname[i] %>% as.character()
  data_ovb = data_mod %>% filter(year == Year, !is.na(Perc_LNP)) %>% select(c(superset$varname %>% as.character), varname)
  formula_ovb = paste0(varname, " ~ .")
  lmod = lm(formula = formula_ovb,
            data = data_ovb)
  OVB_lm$r2[i] = summary(lmod)$r.squared
  OVB_lm$adj_r2[i] = summary(lmod)$adj.r.squared
}

OVB_lm <- OVB_lm %>% mutate(year = Year)

return(OVB_lm)
}

OVB_all <- bind_rows(OVB_fn(2001), OVB_fn(2004), OVB_fn(2007), OVB_fn(2010), OVB_fn(2013), OVB_fn(2016)) %>% 
  select(-adj_r2)

OVB_all %>% 
  ggplot(aes(x=r2, y = reorder(varname, r2))) + 
  geom_point(aes(col = year), size = 2) +
  labs(x = "R-squared", y = "Omitted Variable") 

# Order by average in each row
# Discuss those above 75%
# Others:

# Argue - avoided OVB by construction
# Then discuss why some variables are omitted
```


# Interpretation of more socio-demographics {#a:extrainsights}

This section contains the scatterplots and model visualizations that were omitted from the Insights section.

### Immigrants from the United Kingdom

Electorates with larger populations from the United Kingdom does not have a significant effect on two-party preference in any of the elections. From inspection of 

We expect greater populations from the UK to have a weakly positive relationship with support for the Liberal party (see figure \@ref(fig:rawUK)). The modelled effect is  Our model confirms this. BornUK is insignificant in every election. 

```{r UK1, out.width="100%"}
BornUK_01 <- visreg(fit_ss_01, "BornUK", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE)
BornUK_04 <- visreg(fit_ss_04, "BornUK", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE) 
BornUK_07 <- visreg(fit_ss_07, "BornUK", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE)
BornUK_10 <- visreg(fit_ss_10, "BornUK", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE) 
BornUK_13 <- visreg(fit_ss_13, "BornUK", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE) 
BornUK_16 <- visreg(fit_ss_16, "BornUK", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE) 

grid.arrange(BornUK_01, BornUK_04, BornUK_07, BornUK_10, BornUK_13, BornUK_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Population born in the United Kingdom (relative)", gp = gpar(cex = 0.8)))
```


```{r UK2, fig.cap="Estimated coefficients for population born in the United Kingdom across years with 95% confidence bands."}
# Coefficients
all_coefs %>% filter(term == "BornUK") %>% 
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 2) + 
  lims(y=c(-6.5,2.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "", y = "Coefficient estimate: BornUK")
```

### Rental and Loan Payments

```{r rentloan1, out.width="100%", fig.cap="Partial residual plots for the rental and loan payments factor across years."}
RentLoan_01 <- visreg(fit_ss_01, "RentLoan", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE)
RentLoan_04 <- visreg(fit_ss_04, "RentLoan", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE) 
RentLoan_07 <- visreg(fit_ss_07, "RentLoan", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE)
RentLoan_10 <- visreg(fit_ss_10, "RentLoan", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE) 
RentLoan_13 <- visreg(fit_ss_13, "RentLoan", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE) 
RentLoan_16 <- visreg(fit_ss_16, "RentLoan", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1.8, 5.2), y = c(32,68)) + coord_cartesian(expand = FALSE) 

grid.arrange(RentLoan_01, RentLoan_04, RentLoan_07, RentLoan_10, RentLoan_13, RentLoan_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Rent and Loan prices (factor)", gp = gpar(cex = 0.8)))
```

```{r rentloan2, fig.cap="Estimated coefficients for rental and loan payments across years with 95% confidence bands."}

# Coefficients
all_coefs %>% filter(term == "RentLoan") %>% 
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 2) + 
  lims(y=c(-8,8)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "", y = "Coefficient estimate: RentLoan")
```

### Administrative Jobs and Education

Over all years we see that for moderate-to-high proportions of workers in administrative jobs, low education levels lead to support for the Liberal party. As we increase education, support increases for the Labor party. For at or below average proportions of administrative jobs, there is not as much of an education effect, as electorates for all education levels in this bracket would support Labor. 

```{r admineduc1, fig.cap="Modelled two-party preferred vote (fill) for combinations of education and administrative related jobs."}
admineduc_df <- data.frame(
  AdminJobs = rep(seq(-4,4, by = 0.01), times = 801),
  Education = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  MedianAge = 0,
  OneParentHouse = 0,
  BornUK = 0,
  BornSEEurope = 0,
  ExtractiveJobs = 0,
  RentLoan = 0
)

admineduc_df$z16 = predict(fit_ss_16, admineduc_df) - fit_ss_16$coefficients[1]
admineduc_df$z13 = predict(fit_ss_13, admineduc_df) - fit_ss_13$coefficients[1]
admineduc_df$z10 = predict(fit_ss_10, admineduc_df) - fit_ss_10$coefficients[1]
admineduc_df$z07 = predict(fit_ss_07, admineduc_df) - fit_ss_07$coefficients[1]
admineduc_df$z04 = predict(fit_ss_04, admineduc_df) - fit_ss_04$coefficients[1]
admineduc_df$z01 = predict(fit_ss_01, admineduc_df) - fit_ss_01$coefficients[1]

Educ_Admin_16 <- admineduc_df %>% ggplot(aes(x=Education, y=AdminJobs)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + geom_point(aes(x=Education,y=AdminJobs), data = data_mod %>% filter(year == "2016"), alpha = 0.5, size = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(admineduc_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(admineduc_df$z16)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Admin_13 <- admineduc_df %>% ggplot(aes(x=Education, y=AdminJobs)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + geom_point(aes(x=Education,y=AdminJobs), data = data_mod %>% filter(year == "2013"), alpha = 0.5, size = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(admineduc_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(admineduc_df$z13)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Admin_10 <- admineduc_df %>% ggplot(aes(x=Education, y=AdminJobs)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + geom_point(aes(x=Education,y=AdminJobs), data = data_mod %>% filter(year == "2010"), alpha = 0.5, size = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(admineduc_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(admineduc_df$z10)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Admin_07 <- admineduc_df %>% ggplot(aes(x=Education, y=AdminJobs)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + geom_point(aes(x=Education,y=AdminJobs), data = data_mod %>% filter(year == "2007"), alpha = 0.5, size = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(admineduc_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(admineduc_df$z07)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Admin_04 <- admineduc_df %>% ggplot(aes(x=Education, y=AdminJobs)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + geom_point(aes(x=Education,y=AdminJobs), data = data_mod %>% filter(year == "2004"), alpha = 0.5, size = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(admineduc_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(admineduc_df$z04)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Admin_01 <- admineduc_df %>% ggplot(aes(x=Education, y=AdminJobs)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + geom_point(aes(x=Education,y=AdminJobs), data = data_mod %>% filter(year == "2001"), alpha = 0.5, size = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(admineduc_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(admineduc_df$z01)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

grid.arrange(Educ_Admin_01, Educ_Admin_04, Educ_Admin_07, Educ_Admin_10, Educ_Admin_13, Educ_Admin_16, TPP_scale,
             nrow = 3, 
             widths = c(1,1,1),
             heights = c(0.25, 1, 1),
             layout_matrix = rbind(c(7, 7, 7),
                                   c(1,2,3),
                                   c(4,5,6)), 
             bottom = textGrob("Education level", gp = gpar(cex = 0.8)), 
             left = textGrob("Administrative jobs", gp = gpar(cex = 0.8), rot = 90))

```



