# Insights {#ch:Insights}

This chapter summarises the main findings made about the relationships between socio-demographic chracteristics and voting behaviour. A separate model is estimated for each election, consisting of the same ten main effects and four two-way interactions. Additionally, all socio-demographic variables are centered to have mean zero and standardised to have variance one. Chapter \@ref(ch:Data) on the data processing explained this in detail. By specifying models in this way, estimated socio-demographic effects can be directly compared across elections. These effects are illustrated using data visualization, providing insights into electoral voting behaviour.

*As determined in the previous section, final models for the six elections are estimated separately, consisting of the same ten main effects and four two-way interactions. Furthermore, recall that all socio-demographic variables are centered to have mean zero and standardized to have variance one, within each election year[^7]. By specifying models in this way, estimated socio-demographic effects can be directly compared across elections. In this section, these effects are illustrated using data visualization, providing insights into electoral voting behaviour.*

Plots are used to investigate the variables indicated as being important predictors of voting patterns. There are two main visualisation methods employed; partial residual plots are used for examining main effect contributions, and 2D heatmaps are used to illustrate interaction effects. Partial residual plots show the direction, size and significance of the estimated effect, and 2D heatmaps depict the predicted effect of two-way variable combinations using colour. Each interaction is analysed separately. The variables not included in an interaction (main effects) are analysed in Chapter \@ref(maineff), followed by a discussion of two-way interactions in Chapter \@ref(interactions).

*Given there are two types of variables, those that appear in an interaction and those that only appear as a main effect, we use two main methods of visualization. The estimated effect of variables that do not appear in an interaction are interpreted using partial residual plots. These plots depict the direction, size and significance of the estimated effect in each election. The estimated effect of two-way interactions are illustrated with 2D heatmaps, which depict predictions of two-way variable combinations using colour. Each interaction is analysed separately. We first analyse the variables not included in an interaction (main effects) in Chapter \@ref(maineff), followed by a discussion of two-way interactions in Chapter \@ref(interactions).*

## Main effects {#maineff}

The five socio-demographic variables contributing as main effects only are `BornSEEurope`, `BornUK`, `NoReligion`, `RentLoan` and `CurrentlyStudying`. Partial residual plots are used to examine their contribution over the elections. A partial residual plot is constructed by plotting partial residuals from the model without that variable, against the variable. 

Recall that the fitted model is given by ${\bf \hat y} =  {\bf X} \boldsymbol{\hat\beta}$. Let partial residual vector ${\bf r}_j$ associated with variable $j$, be defined by

*Of the ten socio-demographic variables included in the final models, five are not involved in an interaction. To interpret the estimated effect of one these variables, partial residuals are plotted against that variable, for each election. Before defining the partial residuals, recall that the fitted model is given by ${\bf \hat y} =  {\bf X} \boldsymbol{\hat\beta}$. Let partial residual vector ${\bf r}_j$ associated with variable $j$, be defined by*

$${\bf r}_j = {\bf y} - {\bf X}_{-j}\boldsymbol{\hat\beta}_{-j}$$

where $-j$ indicates the removal of the $j$th column of $\bf X$ and the removal of the $j$th element of $\boldsymbol{\hat\beta}$ [see for example, @Faraway]. Partial residuals are equivalent to $\bf y$ adjusted for all variables other than the $j$th regressor, $\bf x_j$. 

Partial residual plots are produced using the `visreg` package [@visreg], and a prediction line with 95% confidence band is overlaid. The plots reveal the direction, size and significance of the estimated effect, as the slope of the prediction line matches the estimated coefficient. If a horizontal line can be drawn all the way through the 95% confidence band, then the effect is deemed to be statistically insignificant. 

Additional visual summaries can be found in Appendix \@ref(a:extrainsights). Plots of the estimated coefficients with t-based 95% confidence intervals are also included, in addition to the partial residuals plots.

### Migrant population

Two socio-demographic variables in the model relate to migrant populations, `BornSEEurope` and `BornUK`. These represent the proportion of an electorate population born in South-Eastern Europe and the United Kingdom, respectively. Across all six elections, the prediction line for `BornSEEurope` has a significant negative slope (Figure \@ref(fig:SE1)), indicating that electorates with more immigrants from South-Eastern Europe were more likely to support Labor. These slopes do not vary much across years. On the other hand, `BornUK` does not have a significant effect on two-party preference in any of the elections. Partial residual plots for `BornUK` can be located in Appendix \@ref(a:extrainsights). 

```{r SE1, out.width='100%', fig.cap="Partial residual plots for the effect of population born in South-Eastern Europe, across election years. A linear regression line is overlaid to illustrate the decreasing relationship."}
Born_SE_01 <- visreg(fit_ss_01, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm")) +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_04 <- visreg(fit_ss_04, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_07 <- visreg(fit_ss_07, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_10 <- visreg(fit_ss_10, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_13 <- visreg(fit_ss_13, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_16 <- visreg(fit_ss_16, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)

grid.arrange(Born_SE_01, Born_SE_04, Born_SE_07, Born_SE_10, Born_SE_13, Born_SE_16, 
             nrow = 2, 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Population born in South-Eastern Europe", gp = gpar(cex = 0.8)))
```

```{r SE2, out.width='75%', fig.cap="Estimated coefficients for the population born in South-Eastern Europe, across election years and with 95\\% confidence bands. Electorates with higher proportions of South-Eastern European populations were associated with higher Labor party preference."}
# Coefficients
all_coefs %>% filter(term == "BornSEEurope") %>%
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 1) + 
  lims(y=c(-6.5,2.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "Year", y = "Coefficient estimate:\nBornSEEurope")
```

### No Religion

Recall that in Chapter \@ref(ch:Data) it was found that over the years, more Australians have turned away from religion. For the elections up to and including 2007, the proportion of an electorate not identifying with a religion did not have a significant effect. However, from 2010 onwards, less religious electorates became more supportive of the Labor party. This is depicted by significant negative slopes appearing in the partial residual plots (Figure \@ref(fig:norelig1)) from 2010. The slopes do not appear to change much from after 2010.

```{r norelig1, fig.cap="Partial residual plots for the effect of the population proportion not identifying with a religion, across election years. The overlaid regression lines show that a significant negative effect emerges in 2010."}
NoReligion_01 <- visreg(fit_ss_01, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_04 <- visreg(fit_ss_04, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_07 <- visreg(fit_ss_07, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_10 <- visreg(fit_ss_10, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_13 <- visreg(fit_ss_13, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm")) +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE) 
NoReligion_16 <- visreg(fit_ss_16, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)

grid.arrange(NoReligion_01, NoReligion_04, NoReligion_07, NoReligion_10, NoReligion_13, NoReligion_16, 
             nrow = 2, 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Population not identifying with a religion", gp = gpar(cex = 0.8)))
```

```{r norelig2, out.width='75%', fig.cap="Estimated coefficients for population proportion not identifying with a religion, across election years and with 95\\% confidence bands. From 2010 onwards, Labor was assoicated with electorates with a higher proportion of people not identifying with a religion."}
# Coefficients
all_coefs %>% filter(term == "NoReligion") %>% 
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 1) + 
  lims(y=c(-6.5,2.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "Year", y = "Coefficient estimate:\nNoReligion")
```

### Student population

The proportion of the electorate population currently studying is reflected in the variable `CurrentlyStudying`.
In the 2001 and 2004 elections, `CurrentlyStudying` is estimated to have a weak (insignificant) effect in the direction of the Labor party. From 2007, there is a distinct change, as the positive slopes in Figure \@ref(fig:studying) indicate that this effect has shifted towards the Liberal party. Only in 2010 is this relationship significant (by the horizontal line test).

```{r studying, fig.cap="Partial residual plots for the effect of student populations, across election years. A Liberal (positive) effect is estimated from 2007, but is only significant in 2010."}
CurrentlyStudying_01 <- visreg(fit_ss_01, "CurrentlyStudying", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 5), y = c(28,70)) + coord_cartesian(expand = FALSE)
CurrentlyStudying_04 <- visreg(fit_ss_04, "CurrentlyStudying", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 5), y = c(28,70)) + coord_cartesian(expand = FALSE)
CurrentlyStudying_07 <- visreg(fit_ss_07, "CurrentlyStudying", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 5), y = c(28,70)) + coord_cartesian(expand = FALSE)
CurrentlyStudying_10 <- visreg(fit_ss_10, "CurrentlyStudying", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 5), y = c(28,70)) + coord_cartesian(expand = FALSE)
CurrentlyStudying_13 <- visreg(fit_ss_13, "CurrentlyStudying", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm")) +
  lims(x = c(-2.8, 5), y = c(28,70)) + coord_cartesian(expand = FALSE) 
CurrentlyStudying_16 <- visreg(fit_ss_16, "CurrentlyStudying", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"))  +
  lims(x = c(-2.8, 5), y = c(28,70)) + coord_cartesian(expand = FALSE)

grid.arrange(CurrentlyStudying_01, CurrentlyStudying_04, CurrentlyStudying_07, CurrentlyStudying_10, CurrentlyStudying_13, CurrentlyStudying_16, 
             nrow = 2, 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Population currently studying", gp = gpar(cex = 0.8)))
```

```{r studying2, out.width='75%', fig.cap="Estimated coefficients for population currently studying, across election years and with 95\\% confidence bands. The estimated effect shifts from Labor (negative) to Liberal (positive), but is only significant in 2010."}
# Coefficients
all_coefs %>% filter(term == "CurrentlyStudying") %>% 
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 1) + 
  lims(y=c(-3.5,4)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "Year", y = "Coefficient estimate:\nCurrentlyStudying")
```

### Rental and Loan Payments

The factor `RentLoan` combines electoral median rent and loan payments. In the 2010 election, electorates with higher payment amounts were significantly more likely to support the Liberal party, whereas in other elections `RentLoan` did not have a significant effect.

## Interactions {#interactions}

There are four two-way interactions in the final model. For each interaction, 2D heatmaps are used to illustrate the predicted effect of the interacted variables, using colour. White regions represent a combination of the two variables that are predicted to have the same two-party preference as an electorate with mean characteristics, whereas strong red regions identify with the Labor party, and blue are stronger supporters of the Liberal party. For the purpose of illustration, the colour scale of each 2D heatmap is set so that an electorate with mean characteristics has a two-party preferred vote of 50%. Points for the electorates are overlaid on the 2D heatmaps, with each point coloured by its partial residual (see Chapter \@ref(maineff) for a description of partial residuals).

### Education and Age

Even though the population is ageing, and education levels have been improving all across Australia (as seen in Chapter \@ref(ch:Data)), it appears that young electorates with higher education levels have always supported Labor, whereas older electorates with lower education levels have changed from indifferent to supporting the Liberal party. 

The interaction between `MedianAge` and `Education` represents combinations of the electoral age profile, and education levels. In all six elections, young electorates with above-average levels of education consistently support the Labor party, represented by the red region in the bottom right corner of each 2D heatmap in Figure \@ref(fig:educage). For the 2001 and 2004 elections, electorates with a high median age and a low level of education did not vote differently from an electorate with mean characteristics, as shown by the white in the top left corner of the corresponding plots in Figure \@ref(fig:educage). This same region becomes more blue in 2007, and strongly blue from 2010 onwards, meaning that older, less educated electorates became strong supporters of the Liberal party. 

```{r educage, fig.cap="2D heatmap of combinations of education and median age, in each election year. Colour indicates the predicted two-party preferred vote. Electorates with high education levels and low median age consistently support Labor (bottom-right). Older electorates with low education levels shift to support Liberal from 2007 (top-left)."}

# Partial residuals for each year
dat16 <- data_mod %>% 
  filter(year == "2016") %>% 
  mutate(Education = 0, MedianAge = 0)
partials16 <- dat16$Perc_LNP - predict(fit_ss_16, dat16)

dat13 <- data_mod %>% 
  filter(year == "2013") %>% 
  mutate(Education = 0, MedianAge = 0)
partials13 <- dat13$Perc_LNP - predict(fit_ss_13, dat13)

dat10 <- data_mod %>% 
  filter(year == "2010") %>% 
  mutate(Education = 0, MedianAge = 0)
partials10 <- dat10$Perc_LNP - predict(fit_ss_10, dat10)

dat07 <- data_mod %>% 
  filter(year == "2007") %>% 
  mutate(Education = 0, MedianAge = 0)
partials07 <- dat07$Perc_LNP - predict(fit_ss_07, dat07)

dat04 <- data_mod %>% 
  filter(year == "2004") %>% 
  mutate(Education = 0, MedianAge = 0)
partials04 <- dat04$Perc_LNP - predict(fit_ss_04, dat04)

dat01 <- data_mod %>% 
  filter(year == "2001", !is.na(Perc_LNP)) %>% 
  mutate(Education = 0, MedianAge = 0)
partials01 <- dat01$Perc_LNP - predict(fit_ss_01, dat01)


# 2D Heatmap
educage_df <- data.frame(
  MedianAge = rep(seq(-4,4, by = 0.01), times = 801),
  Education = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  AdminJobs = 0,
  OneParentHouse = 0,
  BornUK = 0,
  BornSEEurope = 0,
  ExtractiveJobs = 0,
  RentLoan = 0
)

educage_df$z16 = predict(fit_ss_16, educage_df) - fit_ss_16$coefficients[1]
educage_df$z13 = predict(fit_ss_13, educage_df) - fit_ss_13$coefficients[1]
educage_df$z10 = predict(fit_ss_10, educage_df) - fit_ss_10$coefficients[1]
educage_df$z07 = predict(fit_ss_07, educage_df) - fit_ss_07$coefficients[1]
educage_df$z04 = predict(fit_ss_04, educage_df) - fit_ss_04$coefficients[1]
educage_df$z01 = predict(fit_ss_01, educage_df) - fit_ss_01$coefficients[1]

Educ_Age_16 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z16)))) +  
  geom_point(aes(x=Education,y=MedianAge, col=partials16), alpha = 0.7, data = data_mod %>% filter(year == "2016"), size = 0.8) +  
  geom_point(aes(x=Education,y=MedianAge), shape = 1, data = data_mod %>% filter(year == "2016"), alpha = 0.2, size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials16), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials16)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Age_13 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z13)))) +  
  geom_point(aes(x=Education,y=MedianAge,col=partials13), alpha = 0.7, data = data_mod %>% filter(year == "2013"), size = 0.8) + 
  geom_point(aes(x=Education,y=MedianAge), shape = 1, alpha = 0.2, data = data_mod %>% filter(year == "2013"), size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials13), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials13)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Age_10 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z10)))) +  
  geom_point(aes(x=Education,y=MedianAge, col=partials10), alpha = 0.7, data = data_mod %>% filter(year == "2010"), size = 0.8) +  
  geom_point(aes(x=Education,y=MedianAge), shape = 1, alpha = 0.2,  data = data_mod %>% filter(year == "2010"), size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials10), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials10)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Age_07 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z07)))) +  
  geom_point(aes(x=Education,y=MedianAge, col=partials07), alpha = 0.7, data = data_mod %>% filter(year == "2007"), size = 0.8) +  
  geom_point(aes(x=Education,y=MedianAge), shape = 1, alpha = 0.2, data = data_mod %>% filter(year == "2007"), size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials07), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials07)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Age_04 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z04)))) +  
  geom_point(aes(x=Education,y=MedianAge, col=partials04), alpha = 0.7, data = data_mod %>% filter(year == "2004"), size = 0.8) + 
  geom_point(aes(x=Education,y=MedianAge), shape = 1, alpha = 0.2, data = data_mod %>% filter(year == "2004"), size = 0.8) + 
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials04), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials04)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_Age_01 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z01)))) +  
  geom_point(aes(x=Education,y=MedianAge, col=partials01), alpha = 0.7, data = data_mod %>% filter(year == "2001", !is.na(Perc_LNP)), size = 0.8) +  
  geom_point(aes(x=Education,y=MedianAge), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2001", !is.na(Perc_LNP)), size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials01), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials01)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

# Plot
TPP_scale <- rasterGrob(readPNG("figures/TPP_scale.png"))

grid.arrange(Educ_Age_01, Educ_Age_04, Educ_Age_07, Educ_Age_10, Educ_Age_13, Educ_Age_16, TPP_scale,
             nrow = 3, 
             widths = c(1,1,1),
             heights = c(0.25, 1, 1),
             layout_matrix = rbind(c(7, 7, 7),
                                   c(1,2,3),
                                   c(4,5,6)),
             bottom = textGrob("Education levels", gp = gpar(cex = 0.8)), 
             left = textGrob("Median age", gp = gpar(cex = 0.8), rot = 90))
```

### Education and Single parent households

The proportion of single parent households, `OneParentHouse` is interacted with `Education`, and the predicted two-party preferred vote for each combination is illustrated in Figure \@ref(fig:educOP). Electorates with higher education levels and low proportions of single parent households have been consistently strong supporters of the Liberal party across all elections. It also evident that for all education levels, increasing the proportion of single parent households shifts predicted support away from Liberal towards Labor. This effect is stronger for electorates with higher education levels. 

```{r educOP, fig.cap="2D heatmap of combinations of education levels and the proportion of single parent households, in each election year. Colour indicates the predicted two-party preferred vote. For all education levels, a higher proportion of single parent households shifts predicted support to Labor."}

# Partial residuals for each year
dat16 <- data_mod %>% 
  filter(year == "2016") %>% 
  mutate(Education = 0, OneParentHouse = 0)
partials16 <- dat16$Perc_LNP - predict(fit_ss_16, dat16)

dat13 <- data_mod %>% 
  filter(year == "2013") %>% 
  mutate(Education = 0, OneParentHouse = 0)
partials13 <- dat13$Perc_LNP - predict(fit_ss_13, dat13)

dat10 <- data_mod %>% 
  filter(year == "2010") %>% 
  mutate(Education = 0, OneParentHouse = 0)
partials10 <- dat10$Perc_LNP - predict(fit_ss_10, dat10)

dat07 <- data_mod %>% 
  filter(year == "2007") %>% 
  mutate(Education = 0, OneParentHouse = 0)
partials07 <- dat07$Perc_LNP - predict(fit_ss_07, dat07)

dat04 <- data_mod %>% 
  filter(year == "2004") %>% 
  mutate(Education = 0, OneParentHouse = 0)
partials04 <- dat04$Perc_LNP - predict(fit_ss_04, dat04)

dat01 <- data_mod %>% 
  filter(year == "2001", !is.na(Perc_LNP)) %>% 
  mutate(Education = 0, OneParentHouse = 0)
partials01 <- dat01$Perc_LNP - predict(fit_ss_01, dat01)

educOP_df <- data.frame(
  OneParentHouse = rep(seq(-4,4, by = 0.01), times = 801),
  Education = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  AdminJobs = 0,
  MedianAge = 0,
  BornUK = 0,
  BornSEEurope = 0,
  ExtractiveJobs = 0,
  RentLoan = 0
)

educOP_df$z16 = predict(fit_ss_16, educOP_df) - fit_ss_16$coefficients[1]
educOP_df$z13 = predict(fit_ss_13, educOP_df) - fit_ss_13$coefficients[1]
educOP_df$z10 = predict(fit_ss_10, educOP_df) - fit_ss_10$coefficients[1]
educOP_df$z07 = predict(fit_ss_07, educOP_df) - fit_ss_07$coefficients[1]
educOP_df$z04 = predict(fit_ss_04, educOP_df) - fit_ss_04$coefficients[1]
educOP_df$z01 = predict(fit_ss_01, educOP_df) - fit_ss_01$coefficients[1]

Educ_OP_16 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z16)))) +  
  geom_point(aes(x=Education,y=OneParentHouse, col=partials16), alpha = 0.7, data = data_mod %>% filter(year == "2016"), size = 0.8) +
  geom_point(aes(x=Education,y=OneParentHouse), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2016"), size = 0.8) +
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials16), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials16)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)


Educ_OP_13 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z13)))) +  
  geom_point(aes(x=Education,y=OneParentHouse,col=partials13), alpha = 0.7, data = data_mod %>% filter(year == "2013"), size = 0.8) +
  geom_point(aes(x=Education,y=OneParentHouse), alpha = 0.2, shape=1, data = data_mod %>% filter(year == "2013"), size = 0.8) +
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials13), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials13)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_OP_10 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z10)))) +  
  geom_point(aes(x=Education,y=OneParentHouse, col=partials10), alpha = 0.7, data = data_mod %>% filter(year == "2010"), size = 0.8) +
  geom_point(aes(x=Education,y=OneParentHouse), shape = 1, alpha = 0.2,  data = data_mod %>% filter(year == "2010"), size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials10), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials10)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_OP_07 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z07)))) +  
  geom_point(aes(x=Education,y=OneParentHouse, col=partials07), alpha = 0.7, data = data_mod %>% filter(year == "2007"), size = 0.8) +
  geom_point(aes(x=Education,y=OneParentHouse), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2007"), size = 0.8) +
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials07), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials07)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_OP_04 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z04)))) +  
  geom_point(aes(x=Education,y=OneParentHouse, col=partials04), alpha = 0.7, data = data_mod %>% filter(year == "2004"), size = 0.8) +
  geom_point(aes(x=Education,y=OneParentHouse), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2004"), size = 0.8) +
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials04), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials04)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

Educ_OP_01 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z01)))) +  
  geom_point(aes(x=Education,y=OneParentHouse, col=partials01), alpha = 0.7, data = data_mod %>% filter(year == "2001", !is.na(Perc_LNP)), size = 0.8) +   
  geom_point(aes(x=Education,y=OneParentHouse), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2001", !is.na(Perc_LNP)), size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials01), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials01)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)


grid.arrange(Educ_OP_01, Educ_OP_04, Educ_OP_07, Educ_OP_10, Educ_OP_13, Educ_OP_16, TPP_scale,
             nrow = 3, 
             widths = c(1,1,1),
             heights = c(0.25, 1, 1),
             layout_matrix = rbind(c(7, 7, 7),
                                   c(1,2,3),
                                   c(4,5,6)),
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             bottom = textGrob("Education levels", gp = gpar(cex = 0.8)), 
             left = textGrob("Proportion of single parent households", gp = gpar(cex = 0.8), rot = 90))

```


### Extractive jobs and Administrative jobs

There are two work related variables included in the final model, `ExtractiveJobs` and `AdminJobs`. These reflect the proportion of people working in an industry relating to natural resources (e.g. mining, gas, water, agriculture), and the proportion of administrative jobs (e.g. administration, clerical, sales and managerial roles), respectively. These two variables are included in an interaction, and the fitted effect of possible combinations is depicted in Figure \@ref(fig:jobs1).

Higher values of either `ExtractiveJobs` or `AdminJobs` is associated with increased support for the Liberal party in all elections. Furthermore, electorates with few workers in both of these job types have been supportive of Labor, whereas having many such workers is found to have strong stronger Liberal support. There does not appear to be any evidence of a time-varying effect for these two variables.

```{r jobs1, fig.cap="2D heatmap of combinations of extractive jobs and administrative jobs, in each election year. Colour indicates the predicted two-party preferred vote. Electorates with many workers in both job types are predicted to support Liberal, whilst those with few workers in both job types support Labor."}
# Partial residuals for each year
dat16 <- data_mod %>% 
  filter(year == "2016") %>% 
  mutate(ExtractiveJobs = 0, AdminJobs = 0)
partials16 <- dat16$Perc_LNP - predict(fit_ss_16, dat16)

dat13 <- data_mod %>% 
  filter(year == "2013") %>% 
  mutate(ExtractiveJobs = 0, AdminJobs = 0)
partials13 <- dat13$Perc_LNP - predict(fit_ss_13, dat13)

dat10 <- data_mod %>% 
  filter(year == "2010") %>% 
  mutate(ExtractiveJobs = 0, AdminJobs = 0)
partials10 <- dat10$Perc_LNP - predict(fit_ss_10, dat10)

dat07 <- data_mod %>% 
  filter(year == "2007") %>% 
  mutate(ExtractiveJobs = 0, AdminJobs = 0)
partials07 <- dat07$Perc_LNP - predict(fit_ss_07, dat07)

dat04 <- data_mod %>% 
  filter(year == "2004") %>% 
  mutate(ExtractiveJobs = 0, AdminJobs = 0)
partials04 <- dat04$Perc_LNP - predict(fit_ss_04, dat04)

dat01 <- data_mod %>% 
  filter(year == "2001", !is.na(Perc_LNP)) %>% 
  mutate(ExtractiveJobs = 0, AdminJobs = 0)
partials01 <- dat01$Perc_LNP - predict(fit_ss_01, dat01)


jobs_df <- data.frame(
  AdminJobs = rep(seq(-4,4, by = 0.01), times = 801),
  ExtractiveJobs = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  MedianAge = 0,
  OneParentHouse = 0,
  BornUK = 0,
  BornSEEurope = 0,
  Education = 0,
  RentLoan = 0
)

jobs_df$z16 = predict(fit_ss_16, jobs_df) - fit_ss_16$coefficients[1]
jobs_df$z13 = predict(fit_ss_13, jobs_df) - fit_ss_13$coefficients[1]
jobs_df$z10 = predict(fit_ss_10, jobs_df) - fit_ss_10$coefficients[1]
jobs_df$z07 = predict(fit_ss_07, jobs_df) - fit_ss_07$coefficients[1]
jobs_df$z04 = predict(fit_ss_04, jobs_df) - fit_ss_04$coefficients[1]
jobs_df$z01 = predict(fit_ss_01, jobs_df) - fit_ss_01$coefficients[1]

ExtractiveJobs_Office_16 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z16)))) +  
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs, col=partials16), alpha = 0.7, data = data_mod %>% filter(year == "2016"), size = 0.8) +
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2016"), size = 0.8) +
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials16), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials16)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

ExtractiveJobs_Office_13 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z13)))) +  
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs,col=partials13), alpha = 0.7, data = data_mod %>% filter(year == "2013"), size = 0.8) +
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2013"), size = 0.8) +
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials13), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials13)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

ExtractiveJobs_Office_10 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z10)))) +  
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs, col=partials10), alpha = 0.7, data = data_mod %>% filter(year == "2010"), size = 0.8) +
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs), shape = 1, alpha = 0.2,  data = data_mod %>% filter(year == "2010"), size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials10), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials10)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

ExtractiveJobs_Office_07 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z07)))) +  
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs, col=partials07), alpha = 0.7, data = data_mod %>% filter(year == "2007"), size = 0.8) +
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2007"), size = 0.8) +
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials07), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials07)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

ExtractiveJobs_Office_04 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z04)))) +  
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs, col=partials04), alpha = 0.7, data = data_mod %>% filter(year == "2004"), size = 0.8) +
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2004"), size = 0.8) +
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials04), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials04)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

ExtractiveJobs_Office_01 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5),
        plot.margin=unit(c(0.2,-1.5,-0.5,-1.5), "cm")) + 
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z01)))) +  
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs, col=partials01), alpha = 0.7, data = data_mod %>% filter(year == "2001", !is.na(Perc_LNP)), size = 0.8) +   
  geom_point(aes(x=ExtractiveJobs,y=AdminJobs), alpha = 0.2, shape = 1, data = data_mod %>% filter(year == "2001", !is.na(Perc_LNP)), size = 0.8) +  
  scale_color_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(partials01), -8, -4, -2, 
                                                  0, 2, 4, 8, max(partials01)))) +  
  guides(fill = FALSE, col = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 2/3)

grid.arrange(ExtractiveJobs_Office_01, ExtractiveJobs_Office_04, ExtractiveJobs_Office_07, ExtractiveJobs_Office_10, ExtractiveJobs_Office_13, ExtractiveJobs_Office_16, TPP_scale,
             nrow = 3, 
             widths = c(1,1,1),
             heights = c(0.25, 1, 1),
             layout_matrix = rbind(c(7, 7, 7),
                                   c(1,2,3),
                                   c(4,5,6)),
             bottom = textGrob("Extractive jobs", gp = gpar(cex = 0.8)), 
             left = textGrob("Administrative jobs", gp = gpar(cex = 0.8), rot = 90))

```


### Administrative Jobs and Education

In each election, an electorate with the combination of an above-average proportion of administrative jobs and low education levels is predicted to strongly support the Liberal party. Otherwise, an electorate is predicted to support Labor. This is consistent across elections. 2D heatmaps for this interaction can be found in Appendix \@ref(a:extrainsights).
