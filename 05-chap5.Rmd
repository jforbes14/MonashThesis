# Insights {#ch:Insights}

As determined in the previous section, final models for the six elections are estimated separately, consisting of the same ten main effects and four two-way interactions. Furthermore, recall that all socio-demographic variables are centered to have mean zero and standardized to have variance one, within each election year[^5]. By specifying models in this way, estimated socio-demographic effects can be directly compared across elections. In this section, these effects are extracted from the final models using data visualization, providing insight into electoral voting behaviour.

The variables included in the final model specification, but not in an interaction, are interpreted using partial residual plots. These plots depict the direction, size and significance of the estimated effect in each election. The effect of two-way interactions are illustrated with raster plots, which depict the effect of the possible two-way variable combinations using colour. Each interaction is analysed separately. First, the variables not included in an interaction (main effects) are analysed, followed by two-way interaction terms.

In addition to extracting insights from the models, scatterplots of each socio-demographic variable and the two-party preferred vote are included to illustrate the effects one might expect a model to reveal. 

## Main effects

Of the ten socio-demographic variables included in the final models, five are not involved in an interaction. To interpret the estimated effect of one these variables, partial residuals are plotted against that variable, for each election. Let partial residuals $\bf r_j$ for a variable $j$, which are defined

$${\bf r_j} = {\bf y - X_{-j}}\hat\beta_{\bf -j}$$

where $\bf \text -j$ subscript indicates the removal of the jth column/element [@Faraway], let $\bf y$ denote a vector containing the response variable, let $\bf X$ be a matrix of socio-demographic predictors and let $\hat \beta_j$ be a vector of estimated coefficients. Partial residuals are equivalent to $\bf y$ adjusted for all variables other than $\bf x_j$. 

Each partial residual plot includes a prediction line and 95% confidence band, constucted using tools from the `visreg` package. This reveals the direction, size and significance of the effect, as the slope of the prediction line matches the estimated coefficient. If a horizontal line can be drawn all the way through the 95% confidence band, then the effect is deemed to be statistically insignificant.

### Immigrant population

Scatterplots of the proportion of South-Eastern European immigrants against the two-party preferred vote indicate a negative relationship (figure \@ref(fig:rawSE)). This means that areas with more immigrants from South-Eastern Europe should have a strong relationship with Labor support. After adjusting for other socio-demographics, we find that this holds true. The partial residual plots depict a significantly negative slope, and it does not change much across years (see figures \@ref(fig:SE1) and \@ref(fig:SE2)). 

The other immgrant region in our model is the United Kingdom, which does not have a significant effect on two-party preference in any of the elections. This too aligns with expectations from inspection of the same type of scatterplot, which depicts a weakly positive relationship between larger populations from the United Kingdom and support for the Liberal party. These plots can be found in the appendix F.

We conclude that an electorate's distribution of birthplace is influential, but only due to migrants from South-Eastern Europeans countries.

```{r rawSE, fig.cap="Scatterplot of population born in South-Eastern Europe against two-party preferred vote."}
## Voting against BornSEEurope
data_mod %>% ggplot(aes(x = BornSEEurope, y = Perc_LNP)) + geom_point() + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Population born in South-Eastern Europe", y = "Two-party preferred (%)")
```

```{r SE1, fig.cap="Estimated coefficients for population born in South-Eastern Europe across years with 95\\% confidence bands."}
# Coefficients
all_coefs %>% filter(term == "BornSEEurope") %>%
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 2) + 
  lims(y=c(-6.5,2.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "Year", y = "Coefficient estimate: BornSEEurope")
```


```{r SE2, fig.cap="Partial residual plots for effect of populations born in South-Eastern Europe across years."}
Born_SE_01 <- visreg(fit_ss_01, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_04 <- visreg(fit_ss_04, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_07 <- visreg(fit_ss_07, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_10 <- visreg(fit_ss_10, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_13 <- visreg(fit_ss_13, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_16 <- visreg(fit_ss_16, "BornSEEurope", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)

grid.arrange(Born_SE_01, Born_SE_04, Born_SE_07, Born_SE_10, Born_SE_13, Born_SE_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Population born in South-Eastern Europe (relative)", gp = gpar(cex = 0.8)))
```

### No Religion

In section \@ref(ch:Data) we found that the proportion of people that do not identify with a religion has been increasing over time, and raw data scatterplots (figure \@ref(fig:rawNoRelig)) do not indicate an effect two-party preference. In the elections up to 2007, proportions of areligiousity did not have a significant effect. What we find from 2010 onwards, is quite revealing - less religious electorates are more supporting of the Labor party. The significantly negative slopes do not appear to change much over these last three elections, indicating a lasting shift stemming from the 2010 election (figures \@ref(fig:norelig1) and \@ref(fig:norelig2)).

```{r rawNoRelig, fig.cap="Scatterplot of population not identifying with a religion against two-party preferred vote."}
## Voting against NoReligion
data_mod %>% ggplot(aes(x = NoReligion, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Proportion of population not identifying with a religion", y = "Two-party preferred (%)")
```


```{r norelig1, fig.cap="Estimated coefficients for population not identifying with a religion with 95\\% confidence bands."}
# Coefficients
all_coefs %>% filter(term == "NoReligion") %>% 
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 2) + 
  lims(y=c(-6.5,2.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "Year", y = "Coefficient estimate: NoReligion")
```


```{r norelig2, fig.cap="Partial residual plots against population not identifying with a religion."}
NoReligion_01 <- visreg(fit_ss_01, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_04 <- visreg(fit_ss_04, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_07 <- visreg(fit_ss_07, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_10 <- visreg(fit_ss_10, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_13 <- visreg(fit_ss_13, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE) 
NoReligion_16 <- visreg(fit_ss_16, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)

grid.arrange(NoReligion_01, NoReligion_04, NoReligion_07, NoReligion_10, NoReligion_13, NoReligion_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Population not identifying with a religion (relative)", gp = gpar(cex = 0.8)))
```

### Student population

Education policy is typically a key policy issue in the weeks leading up to a federal election. The Labor party, more often than not, campaign with policies that boost funding for education - for example, the "Better Schools Plan" in 2013. We are not surprised by the negative relationship that appears in the scatterplots, as it seems reasonable that higher student populations would be inclined to support Labor. However, after accounting for other socio-demographic variables, we find that student populations were insignificant in electorate party preference for all but 2010 - in which higher student populations had a positive relationship with the Liberal party. See appendix F for the corresponding plots.

### Rental and Loan Payments

There is no reason to expect rental prices and mortgage loan repayments to have a distinct relationship with party preference, based on the scatterplots. We find that in the 2010 election, higher median payment amounts had a significant positive relationship with support for the Liberal party, whereas there was no effect in the others.

## Interactions

There are four two-way interactions in the final models. For each interaction, raster plots are used to illustrate the predicted effect of the interacted variables, using colour. White regions represent a combination of the two variables that are predicted to have the same two-party preference as an electorate with mean characteristics, whereas strong red regions identify more with the Labor party, and blue are stronger supporters of the Liberal party.

### Education and Age

In a similar way that we expected Labor's favourable education policies to influence student populations' voter preference, we might expect education levels to behave in the same way - although the scatterplots do not indicate much of a relationship. On the contrary, older age profiles (higher median age) appear to have a strong relationship with Liberal support.

We find that the young electorates with and above-average levels of education consistently support the Labor party, represented by the red region in the bottom right corner of each plot in \@ref(fig:educage). The older electorates with lowest levels of education did not appear to have affiliation with either party in the first three elections. From 2010 onwards, this same region (top left) is blue, indicating that older, low education electorates have shift to supporting the Liberal party.

Even though the population is ageing, and education levels have been improving all across Australia (as seen in section \@ref(ch:Data)), it appears that the young electorates with higher education levels have always supported Labor, whereas older electorates with lower education levels have changed from indifferent to supporting the Liberal party. 

```{r raweduc, fig.cap="Scatterplot of education levels against two-party preferred vote."}
## Voting against Education
data_mod %>% ggplot(aes(x = Education, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Education level", y = "Two-party preferred (%)")
```


```{r rawage, fig.cap="Scatterplot of median age against two-party preferred vote."}
## Voting against MedianAge
data_mod %>% ggplot(aes(x = MedianAge, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Median age", y = "Two-party preferred (%)")
```

```{r educage, fig.cap="Modelled two-party preferred vote (fill) for combinations of education and median age."}
educage_df <- data.frame(
  MedianAge = rep(seq(-4,4, by = 0.01), times = 801),
  Education = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  AdminJobs = 0,
  OneParentHouse = 0,
  BornUK = 0,
  BornSEEurope = 0,
  ExtractiveJobs = 0,
  RentLoan = 0
)

educage_df$z16 = predict(fit_ss_16, educage_df) - fit_ss_16$coefficients[1]
educage_df$z13 = predict(fit_ss_13, educage_df) - fit_ss_13$coefficients[1]
educage_df$z10 = predict(fit_ss_10, educage_df) - fit_ss_10$coefficients[1]
educage_df$z07 = predict(fit_ss_07, educage_df) - fit_ss_07$coefficients[1]
educage_df$z04 = predict(fit_ss_04, educage_df) - fit_ss_04$coefficients[1]
educage_df$z01 = predict(fit_ss_01, educage_df) - fit_ss_01$coefficients[1]

Educ_Age_16 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=MedianAge), data = data_mod %>% filter(year == "2016"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z16)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_13 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=MedianAge), data = data_mod %>% filter(year == "2013"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z13)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_10 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=MedianAge), data = data_mod %>% filter(year == "2010"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z10)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_07 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=MedianAge), data = data_mod %>% filter(year == "2007"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z07)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_04 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=MedianAge), data = data_mod %>% filter(year == "2004"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z04)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_01 <- educage_df %>% ggplot(aes(x=Education, y=MedianAge)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=MedianAge), data = data_mod %>% filter(year == "2001"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z01)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

grid.arrange(Educ_Age_01, Educ_Age_04, Educ_Age_07, Educ_Age_10, Educ_Age_13, Educ_Age_16, 
             nrow = 2, 
             bottom = textGrob("Education levels", gp = gpar(cex = 0.8)), 
             left = textGrob("Median age", gp = gpar(cex = 0.8), rot = 90))
```

```{r educagescale, out.width = "50%"}
## TPP scale
TPP_scale <- readPNG("figures/TPP_scale.png")
 grid.raster(TPP_scale)
```

### Education and Single parent households

```{r rawOP, fig.cap = "Scatterplot of single parent households against two-party preferred vote."}
## Voting against OneParentHouse
data_mod %>% ggplot(aes(x = OneParentHouse, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Proportion of single parent households", y = "Two-party preferred (%)")
```

Scatterplots indicate that a strong negative relationship between the proportion of single parent households and support for the Liberal party - which is reasonable as Labor often propose policies that benefit families, and particularly single parent families. What we find is that this effect is true, but varies across levels of education, with higher educations levels experiencing a stronger effect of single parent households. This is seen in figure \@ref(fig:educOP), as the vertical transition from blue to red for highly educated electorates appears to occur faster than for electorates with lower education. A strong pocket of Liberal support is visible for high levels of education and few single parent households across all elections.

```{r educOP, fig.cap="Modelled two-party preferred vote (fill) for combinations of education and proportion of single parent households."}
educOP_df <- data.frame(
  OneParentHouse = rep(seq(-4,4, by = 0.01), times = 801),
  Education = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  AdminJobs = 0,
  MedianAge = 0,
  BornUK = 0,
  BornSEEurope = 0,
  ExtractiveJobs = 0,
  RentLoan = 0
)

educOP_df$z16 = predict(fit_ss_16, educOP_df) - fit_ss_16$coefficients[1]
educOP_df$z13 = predict(fit_ss_13, educOP_df) - fit_ss_13$coefficients[1]
educOP_df$z10 = predict(fit_ss_10, educOP_df) - fit_ss_10$coefficients[1]
educOP_df$z07 = predict(fit_ss_07, educOP_df) - fit_ss_07$coefficients[1]
educOP_df$z04 = predict(fit_ss_04, educOP_df) - fit_ss_04$coefficients[1]
educOP_df$z01 = predict(fit_ss_01, educOP_df) - fit_ss_01$coefficients[1]

Educ_OP_16 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=OneParentHouse), data = data_mod %>% filter(year == "2016"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z16)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_13 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=OneParentHouse), data = data_mod %>% filter(year == "2013"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z13)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_10 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=OneParentHouse), data = data_mod %>% filter(year == "2010"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z10)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_07 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=OneParentHouse), data = data_mod %>% filter(year == "2007"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z07)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_04 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=OneParentHouse), data = data_mod %>% filter(year == "2004"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z04)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_01 <- educOP_df %>% ggplot(aes(x=Education, y=OneParentHouse)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Education,y=OneParentHouse), data = data_mod %>% filter(year == "2001"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z01)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

grid.arrange(Educ_OP_01, Educ_OP_04, Educ_OP_07, Educ_OP_10, Educ_OP_13, Educ_OP_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             bottom = textGrob("Education levels", gp = gpar(cex = 0.8)), 
             left = textGrob("Proportion of single parent households", gp = gpar(cex = 0.8), rot = 90))

```

```{r educOPscale, out.width = "50%"}
## TPP scale
TPP_scale <- readPNG("figures/TPP_scale.png")
 grid.raster(TPP_scale)
```

### ExtractiveJobs and administrative jobs

Two industries of work are included in our model - ExtractiveJobs and administrative jobs. ExtractiveJobs jobs relate to natural resources (e.g. mining, gas, water, agriculture etc.) and administrative jobs include administration, clerical, sales and managerial roles. We expect that higher incidences of these should both have strong positive effects on support for the Liberal party, as scatterplots indicate strong positive relationships.

```{r, fig.cap="Scatterplot of population working in ExtractiveJobs jobs against two-party preferred vote."}
## Voting against ExtractiveJobs
data_mod %>% ggplot(aes(x = ExtractiveJobs, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Jobs in ExtractiveJobs industries", y = "Two-party preferred (%)")
```


```{r, fig.cap="Scatterplot of population working in administrative jobs against two-party preferred vote."}
## Voting against AdminJobs
data_mod %>% ggplot(aes(x = AdminJobs, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Administrative jobs", y = "Two-party preferred (%)")
```

Increasing percentages of people employed in either industry, holding the other fixed, have increased support for the Liberal party in all elections. The interaction coefficient is close to zero in all elections (aside from 2010), meaning that effects are close to being independent. Electorates with few workers in both of these job types have been supportive of Labor, whereas having many workers in both lead to Liberal support, in all years.

```{r jobs1, fig.cap="Modelled two-party preferred vote (fill) for combinations of ExtractiveJobs and administrative related jobs."}
jobs_df <- data.frame(
  AdminJobs = rep(seq(-4,4, by = 0.01), times = 801),
  ExtractiveJobs = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  MedianAge = 0,
  OneParentHouse = 0,
  BornUK = 0,
  BornSEEurope = 0,
  Education = 0,
  RentLoan = 0
)

jobs_df$z16 = predict(fit_ss_16, jobs_df) - fit_ss_16$coefficients[1]
jobs_df$z13 = predict(fit_ss_13, jobs_df) - fit_ss_13$coefficients[1]
jobs_df$z10 = predict(fit_ss_10, jobs_df) - fit_ss_10$coefficients[1]
jobs_df$z07 = predict(fit_ss_07, jobs_df) - fit_ss_07$coefficients[1]
jobs_df$z04 = predict(fit_ss_04, jobs_df) - fit_ss_04$coefficients[1]
jobs_df$z01 = predict(fit_ss_01, jobs_df) - fit_ss_01$coefficients[1]

ExtractiveJobs_Office_16 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=ExtractiveJobs,y=AdminJobs), data = data_mod %>% filter(year == "2016"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z16)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

ExtractiveJobs_Office_13 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=ExtractiveJobs,y=AdminJobs), data = data_mod %>% filter(year == "2013"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z13)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

ExtractiveJobs_Office_10 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=ExtractiveJobs,y=AdminJobs), data = data_mod %>% filter(year == "2010"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z10)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

ExtractiveJobs_Office_07 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=ExtractiveJobs,y=AdminJobs), data = data_mod %>% filter(year == "2007"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z07)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

ExtractiveJobs_Office_04 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=ExtractiveJobs,y=AdminJobs), data = data_mod %>% filter(year == "2004"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z04)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

ExtractiveJobs_Office_01 <- jobs_df %>% ggplot(aes(x=ExtractiveJobs, y=AdminJobs)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=ExtractiveJobs,y=AdminJobs), data = data_mod %>% filter(year == "2001"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z01)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

grid.arrange(ExtractiveJobs_Office_01, ExtractiveJobs_Office_04, ExtractiveJobs_Office_07, ExtractiveJobs_Office_10, ExtractiveJobs_Office_13, ExtractiveJobs_Office_16, 
             nrow = 2, 
             bottom = textGrob("ExtractiveJobs jobs", gp = gpar(cex = 0.8)), 
             left = textGrob("Administrative jobs", gp = gpar(cex = 0.8), rot = 90))

```

```{r jobsscale, out.width="50%"}
## TPP scale
TPP_scale <- readPNG("figures/TPP_scale.png")
 grid.raster(TPP_scale)
```

### Administrative Jobs and Education

Over all years we see that the combination of above-average proportions of administrative jobs and low education levels support for the Liberal party. Increasing education levels has always increased support for Labor amongst these same areas with above-average adminstrative jobs. Whilst we see that the support predicted for electorates high education levels, with few adminstrative jobs has transitioned from Liberal to Labor over the years, no electorates are ever observed in this region (see appendix F). 

## Diagnostics

### Residuals

```{r augment}
aug_all <- bind_rows(augment(fit_ss_01) %>% mutate(year = "2001"), 
                     augment(fit_ss_04) %>% mutate(year = "2004"), 
                     augment(fit_ss_07) %>% mutate(year = "2007"), 
                     augment(fit_ss_10) %>% mutate(year = "2010"), 
                     augment(fit_ss_13) %>% mutate(year = "2013"), 
                     augment(fit_ss_16) %>% mutate(year = "2016"))
```

There are is little evidence of residual non-normality in the histograms and quantile-quantile plots, nor are there signs of residual heteroskedasticity (figures in \@ref(fig:alldiagnostics)). We produced plots of residuals against predictors in the model, which did not reveal any significant non-linear relationships. Doing the same for residuals against predictors excluded from the model, we do not find evidence of significant relationships between omitted socio-demographics and the residuals (see appendix D). All of this validates our assumptions about the distribution of the errors, and our model specification.

```{r alldiagnostics, fig.cap = "Diagnostics plots. Left are the histograms of the residuals in each year. Middle are the quantile-quantile plots. Right are the residuals against fitted values."}
# Histogram
d1 <- aug_all %>% 
  ggplot(aes(x = .resid)) + 
  geom_histogram() +
  facet_wrap(~year, nrow = 6) + 
  labs(x = "Residuals", y = "Count", title = "Residual histograms") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

# QQ plots
d2 <- aug_all %>% 
  ggplot(aes(sample = .resid)) + 
  geom_qq(alpha = 0.4) + geom_qq_line() + 
  facet_wrap(~year, nrow = 6) +
  labs(x = "Theoretical quantiles", y = "Sample residual quantiles", title = "Residual quantile-quantile plots") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

# Residuals vs fitted
d3 <- aug_all %>% 
  ggplot(aes(x=.fitted, y=.resid)) + 
  geom_point() + geom_smooth() +
  facet_wrap(~year, nrow = 6) + 
  labs(x = "Fitted values", y = "Residuals", title = "Residuals against fitted values") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

grid.arrange(d1,d2,d3, nrow = 1)
```

### Influence

Across the six elections, only two electorates have moderately large influence - Kalgoorlie (2001, 2004) and Sydney (2007, 2016) - as they have cook's distance greater than 0.2. The Kalgoorlie electorate supports the Liberal party  in these years ($TPP$ of around 55), but has an extremely low incidence of administrative jobs and a high incidence of atheism which are strong factors of Labor support. Sydney is a staunch Labor electorate, with $TPP$ ranging from 30.50% to 35.35% across the six years, but has very large student populations, low incidence of single parent households and high rental/loan prices. All of the observations with moderately large influence have hat values over 0.3, indicating that these also have unusual socio-demographic compositions.

The most influential electorate is Kalgoorlie in 2001, with cook distance of 0.31. As this is not particularly high, it does not appear that there are any outliers that have high influence on the model, and hence no observations should be removed. 

### Goodness-of-fit

The election models have adjusted R-squared between $[0.67, 0.77]$, indicating that socio-demographics are able to explain most of the variation in two-party preference.

```{r modelfit, fig.cap = "Fitted versus actual two-party preferred vote in each election"}
aug_all %>% 
  ggplot(aes(x=.fitted, y=Perc_LNP)) + 
  geom_abline(col = "blue", alpha = 0.5, size = 1) + 
  geom_point() + 
  facet_wrap(~year) +
  labs(x = "Fitted two-party preferred (%)", y = "Actual two-party preferred (%)") +
  theme_bw() + 
  theme(axis.title = element_text(size = 12))
```

\begin{table}[!htbp] \centering 
\small
\begin{tabular}{@{\extracolsep{5pt}}lcccccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{6}{c}{\textit{Dependent variable:}} \\ 
\cline{2-7} 
\\[-1.8ex] & \multicolumn{6}{c}{Two-party preferred vote (percentage point)} \\ 
\\[-1.8ex] & (2001) & (2004) & (2007) & (2010) & (2013) & (2016)\\ 
\hline \\[-1.8ex] 
R$^{2}$ & 0.777 & 0.782 & 0.793 & 0.730 & 0.752 & 0.701 \\ 
Adjusted R$^{2}$ & 0.753 & 0.759 & 0.772 & 0.702 & 0.726 & 0.670 \\ 
\hline 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

## A typical electorate

Based on the most recent (2016) election, we construct a hypothetical electorate that would be most likely to support each party.

\begin{table}[!htbp] \centering 
\normalsize
\begin{tabular}{@{\extracolsep{5pt}}lcccccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{2}{c}{\textit{A typical electorate in 2016:}} \\ 
\cline{2-3}
\\[-1.8ex] & \bf{Labor} & \bf{Liberal} \\ 
\hline \\[-1.8ex] 
\bf{Age} & Young & Old \\ 
\bf{Atheists} & Many & Few \\
\bf{Immigrants} & Many & Few \\
\bf{Education} & High & Low \\
\bf{Student population} & Low & High \\
\bf{Rent and loan payments} & Low & High \\
\bf{ExtractiveJobs workers} & Few & Many \\
\bf{Administrative workers} & Few & Many \\
\bf{Single parent households} & Many & Few \\
\hline 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

[^5]: See Section \@ref(ch:Data)