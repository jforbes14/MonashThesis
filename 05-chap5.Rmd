# Insights {#ch:Insights}

As socio-demographic variables are standardized within each election year, and model specification is consistent across elections, we can directly compare the estimated effects of covariates across elections and obtain rich insights into how the two-party preferred vote has been affected by socio-demographics. In the following section, we outline our expectations based on the raw data, and extract findings from the estimated models. 

In our final model, five of the ten variables in the model are not included in an interaction, so we can interpret their marginal effects directly. To illustrate these effects, we plot partial residuals against the predictor with a prediction line and 95% confidence band, using tools from the `visreg` package. This reveals the direction and significance of the effect, and the slope matches the estimated coefficient. Plots of the estimated coefficients with 95% confidence bands are also included. 

Raster plots are constructed for each of the two-way interactions, which illustrate the predicted effect of each combination of the interacted (continuous) variables, using colour. White regions represent a combination that does not have an affiliation with either party, whereas strong red regions identify with Labor, and blue support Liberal. The main effect of a variable in an interaction can also be directly interpreted when its counterpart is fixed at zero - which is the mean in this case, as variables have been standardized.

Note that partial residuals for a variable $j$ are given by: ${\bf r_j} = {\bf y - X_{-j}}\hat\beta_{\bf -j}$, where -j subscript indicates the removal of the jth column/element (@Faraway16). These are equivalent $y$ adjusted for all variables other than $x_j$. In a partial residual plot, if we can draw a horizontal line all the way through the 95% confidence band, then the effect is not significant.

## Main effects

### Immigrant population

Scatterplots of the proportion of South-Eastern European immigrants against the two-party preferred vote indicate a negative relationship (figure \@ref(fig:rawSE)). This means that areas with more immigrants from South-Eastern Europe should have a strong relationship with Labor support. After adjusting for other socio-demographics, we find that this holds true. The partial residual plots depict a significantly negative slope, and it does not change much across years (see figures \@ref(fig:SE1) and \@ref(fig:SE2)). 

The other immgrant region in our model is the United Kingdom, which does not have a significant effect on two-party preference in any of the elections. This too aligns with expectations from inspection of the same type of scatterplot, which depicts a weakly positive relationship between larger populations from the United Kingdom and support for the Liberal party. These plots can be found in the appendix F.

We conclude that an electorate's distribution of birthplace is influential, but only due to migrants from South-Eastern Europeans countries.

```{r rawSE, fig.cap="Scatterplot of population born in South-Eastern Europe against two-party preferred vote."}
## Voting against Born_SE_Europe
data_mod %>% ggplot(aes(x = Born_SE_Europe, y = Perc_LNP)) + geom_point() + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Population born in South-Eastern Europe", y = "Two-party preferred (%)")
```

```{r SE1, fig.cap="Estimated coefficients for population born in South-Eastern Europe across years with 95\\% confidence bands."}
# Coefficients
all_coefs %>% filter(term == "Born_SE_Europe") %>% 
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 2) + 
  lims(y=c(-6.5,2.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "Year", y = "Coefficient estimate: BornSEEurope")
```


```{r SE2, fig.cap="Partial residual plots for effect of populations born in South-Eastern Europe across years."}
Born_SE_01 <- visreg(fit_ss_01, "Born_SE_Europe", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_04 <- visreg(fit_ss_04, "Born_SE_Europe", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_07 <- visreg(fit_ss_07, "Born_SE_Europe", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_10 <- visreg(fit_ss_10, "Born_SE_Europe", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_13 <- visreg(fit_ss_13, "Born_SE_Europe", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)
Born_SE_16 <- visreg(fit_ss_16, "Born_SE_Europe", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-1,5.2), y = c(23,70)) + coord_cartesian(expand = FALSE)

grid.arrange(Born_SE_01, Born_SE_04, Born_SE_07, Born_SE_10, Born_SE_13, Born_SE_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Population born in South-Eastern Europe (relative)", gp = gpar(cex = 0.8)))
```

### No Religion

In section X we found that the proportion of people that do not identify with a religion has been increasing over time, and yet the raw data scatterplots (figure \@ref(fig:rawNoRelig)) do not indicate an effect two-party preference. In the elections up to 2007, proportions of areligiousity did not have a significant effect. What we find from 2010 onwards, is quite revealing - less religious electorates are more supporting of the Labor party. The significantly negative slopes do not appear to change much over these last three elections, indicating a lasting shift stemming from the 2010 election (figures \@ref(fig:norelig1) and \@ref(fig:norelig2)).

```{r rawNoRelig, fig.cap="Scatterplot of population not identifying with a religion against two-party preferred vote."}
## Voting against NoReligion
data_mod %>% ggplot(aes(x = NoReligion, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Proportion of population not identifying with a religion", y = "Two-party preferred (%)")
```


```{r norelig1, fig.cap="Estimated coefficients for population not identifying with a religion with 95\\% confidence bands."}
# Coefficients
all_coefs %>% filter(term == "NoReligion") %>% 
  ggplot(aes(x=year, y=estimate)) +
  geom_point(size = 3) + geom_linerange(aes(ymin = lower95, ymax = upper95), size = 1.5) + 
  geom_hline(aes(yintercept = 0), alpha = 0.5, size = 2) + 
  lims(y=c(-6.5,2.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        axis.title = element_text(size = 12)) + 
  coord_fixed(0.15) + 
  labs(x = "Year", y = "Coefficient estimate: NoReligion")
```


```{r norelig2, fig.cap="Partial residual plots against population not identifying with a religion."}
NoReligion_01 <- visreg(fit_ss_01, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_04 <- visreg(fit_ss_04, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_07 <- visreg(fit_ss_07, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_10 <- visreg(fit_ss_10, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)
NoReligion_13 <- visreg(fit_ss_13, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE) 
NoReligion_16 <- visreg(fit_ss_16, "NoReligion", gg = T, print.cond = FALSE) + 
  labs(x = "", y = "", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5))  +
  lims(x = c(-2.8, 2.8), y = c(28,70)) + coord_cartesian(expand = FALSE)

grid.arrange(NoReligion_01, NoReligion_04, NoReligion_07, NoReligion_10, NoReligion_13, NoReligion_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             left = textGrob("Two-party preferred vote (%)", gp = gpar(cex = 0.8), rot = 90), 
             bottom = textGrob("Population not identifying with a religion (relative)", gp = gpar(cex = 0.8)))
```

### Student population

Education policy is typically a key policy issue in the weeks leading up to a federal election. The Labor party, more often than not, campaign with policies that boost funding for education - for example, the "Better Schools Plan" in 2013. We are not surprised by the negative relationship that appears in the scatterplots, as it seems reasonable that higher student populations would be inclined to support Labor. However, after accounting for other socio-demographic variables, we find that student populations were insignificant in electorate party preference for all but 2010 - in which higher student populations had a positive relationship with the Liberal party. See appendix F for the corresponding plots.

### Rental and Loan Payments

There is no reason to expect rental prices and mortgage loan repayments to have a distinct relationship with party preference, based on the scatterplots. We find that in the 2010 election, higher median payment amounts had a significant positive relationship with support for the Liberal party, whereas there was no effect in the others.

## Interactions

### Education and Age

In a similar way that we expected Labor's favourable education policies to influence student populations' voter preference, we might expect education levels to behave in the same way - although the scatterplots do not indicate much of a relationship. On the contrary, older age profiles (higher median age) appear to have a strong relationship with Liberal support.

We find that the young electorates with and above-average levels of education consistently support the Labor party, represented by the red region in the bottom right corner of each plot in \@ref(fig:educage). The older electorates with lowest levels of education did not appear to have affiliation with either party in the first three elections. From 2010 onwards, this same region (top left) is blue, indicating that older, low education electorates now support the Liberal party.

Even though the population is ageing, and education levels have been improving all across Australia (as seen in section X), it appears that the young electorates with higher education levels have always supported Labor, whereas older electorates with lower education levels have changed from indifferent to supporting the Liberal party. 

```{r raweduc, fig.cap="Scatterplot of education levels against two-party preferred vote."}
## Voting against Educ
data_mod %>% ggplot(aes(x = Educ, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Education level", y = "Two-party preferred (%)")
```


```{r rawage, fig.cap="Scatterplot of median age against two-party preferred vote."}
## Voting against MedianAge
data_mod %>% ggplot(aes(x = MedianAge, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Median age", y = "Two-party preferred (%)")
```


```{r educage, fig.cap="Modelled two-party preferred vote (fill) for combinations of education and median age."}
educage_df <- data.frame(
  MedianAge = rep(seq(-4,4, by = 0.01), times = 801),
  Educ = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  ManagerAdminClericalSales = 0,
  OneParent_House = 0,
  Born_UK = 0,
  Born_SE_Europe = 0,
  Extractive = 0,
  RentLoan = 0
)

educage_df$z16 = predict(fit_ss_16, educage_df) - fit_ss_16$coefficients[1]
educage_df$z13 = predict(fit_ss_13, educage_df) - fit_ss_13$coefficients[1]
educage_df$z10 = predict(fit_ss_10, educage_df) - fit_ss_10$coefficients[1]
educage_df$z07 = predict(fit_ss_07, educage_df) - fit_ss_07$coefficients[1]
educage_df$z04 = predict(fit_ss_04, educage_df) - fit_ss_04$coefficients[1]
educage_df$z01 = predict(fit_ss_01, educage_df) - fit_ss_01$coefficients[1]

Educ_Age_16 <- educage_df %>% ggplot(aes(x=Educ, y=MedianAge)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=MedianAge), data = data_mod %>% filter(year == "2016"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z16)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_13 <- educage_df %>% ggplot(aes(x=Educ, y=MedianAge)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=MedianAge), data = data_mod %>% filter(year == "2013"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z13)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_10 <- educage_df %>% ggplot(aes(x=Educ, y=MedianAge)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=MedianAge), data = data_mod %>% filter(year == "2010"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z10)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_07 <- educage_df %>% ggplot(aes(x=Educ, y=MedianAge)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=MedianAge), data = data_mod %>% filter(year == "2007"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z07)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_04 <- educage_df %>% ggplot(aes(x=Educ, y=MedianAge)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=MedianAge), data = data_mod %>% filter(year == "2004"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z04)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

Educ_Age_01 <- educage_df %>% ggplot(aes(x=Educ, y=MedianAge)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=MedianAge), data = data_mod %>% filter(year == "2001"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educage_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educage_df$z01)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-2.8, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.8/5.8)

grid.arrange(Educ_Age_01, Educ_Age_04, Educ_Age_07, Educ_Age_10, Educ_Age_13, Educ_Age_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             bottom = textGrob("Education levels", gp = gpar(cex = 0.8)), 
             left = textGrob("Median age", gp = gpar(cex = 0.8), rot = 90))

```

```{r educage_scale, out.width = "50%"}
## TPP scale
TPP_scale <- readPNG("figures/TPP_scale.png")
 grid.raster(TPP_scale)
```

### Education and Single parent households

```{r rawOP, fig.cap = "Scatterplot of single parent households against two-party preferred vote."}
## Voting against OneParent_House
data_mod %>% ggplot(aes(x = OneParent_House, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Proportion of single parent households", y = "Two-party preferred (%)")
```

Scatterplots indicate that a strong negative relationship between the proportion of single parent households and support for the Liberal party - which is reasonable as Labor often propose policies that benefit families, and particularly single parent families. What we find is that this effect is true, but varies across levels of education, with higher educations levels experiencing a stronger effect of single parent households. This is seen in figure \@ref(fig:educOP), as the vertical transition from blue to red for highly educated electorates appears to occur faster than for electorates with lower education. A strong pocket of Liberal support is visible for high levels of education and few single parent households across all elections.

```{r educOP, fig.cap="Modelled two-party preferred vote (fill) for combinations of education and proportion of single parent households."}
educOP_df <- data.frame(
  OneParent_House = rep(seq(-4,4, by = 0.01), times = 801),
  Educ = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  ManagerAdminClericalSales = 0,
  MedianAge = 0,
  Born_UK = 0,
  Born_SE_Europe = 0,
  Extractive = 0,
  RentLoan = 0
)

educOP_df$z16 = predict(fit_ss_16, educOP_df) - fit_ss_16$coefficients[1]
educOP_df$z13 = predict(fit_ss_13, educOP_df) - fit_ss_13$coefficients[1]
educOP_df$z10 = predict(fit_ss_10, educOP_df) - fit_ss_10$coefficients[1]
educOP_df$z07 = predict(fit_ss_07, educOP_df) - fit_ss_07$coefficients[1]
educOP_df$z04 = predict(fit_ss_04, educOP_df) - fit_ss_04$coefficients[1]
educOP_df$z01 = predict(fit_ss_01, educOP_df) - fit_ss_01$coefficients[1]

Educ_OP_16 <- educOP_df %>% ggplot(aes(x=Educ, y=OneParent_House)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=OneParent_House), data = data_mod %>% filter(year == "2016"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z16)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_13 <- educOP_df %>% ggplot(aes(x=Educ, y=OneParent_House)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=OneParent_House), data = data_mod %>% filter(year == "2013"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z13)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_10 <- educOP_df %>% ggplot(aes(x=Educ, y=OneParent_House)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=OneParent_House), data = data_mod %>% filter(year == "2010"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z10)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_07 <- educOP_df %>% ggplot(aes(x=Educ, y=OneParent_House)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=OneParent_House), data = data_mod %>% filter(year == "2007"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z07)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_04 <- educOP_df %>% ggplot(aes(x=Educ, y=OneParent_House)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=OneParent_House), data = data_mod %>% filter(year == "2004"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z04)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

Educ_OP_01 <- educOP_df %>% ggplot(aes(x=Educ, y=OneParent_House)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Educ,y=OneParent_House), data = data_mod %>% filter(year == "2001"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(educOP_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(educOP_df$z01)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1.5,3.3), y = c(-3.0, 3.3)) + coord_fixed(expand=FALSE, ratio = 4.8/6.3)

grid.arrange(Educ_OP_01, Educ_OP_04, Educ_OP_07, Educ_OP_10, Educ_OP_13, Educ_OP_16, 
             nrow = 2, 
             #top = textGrob("South-Eastern European Influence", gp = gpar(cex = 0.8)), 
             bottom = textGrob("Education levels", gp = gpar(cex = 0.8)), 
             left = textGrob("Proportion of single parent households", gp = gpar(cex = 0.8), rot = 90))

```

```{r educOP_scale, out.width = "50%"}
## TPP scale
TPP_scale <- readPNG("figures/TPP_scale.png")
 grid.raster(TPP_scale)
```

### Extractive and administrative jobs

Two industries of work are included in our model - extractive and administrative jobs. Extractive jobs relate to natural resources (e.g. mining, gas, water, agriculture etc.) and administrative jobs include administration, clerical, sales and managerial roles. We expect that higher incidences of these should both have strong positive effects on support for the Liberal party, as scatterplots indicate strong positive relationships.

```{r, fig.cap="Scatterplot of population working in extractive jobs against two-party preferred vote."}
## Voting against Extractive
data_mod %>% ggplot(aes(x = Extractive, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Jobs in extractive industries", y = "Two-party preferred (%)")
```


```{r, fig.cap="Scatterplot of population working in administrative jobs against two-party preferred vote."}
## Voting against ManagerAdminClericalSales
data_mod %>% ggplot(aes(x = ManagerAdminClericalSales, y = Perc_LNP)) + geom_point(aes(label = Election_Division)) + geom_smooth(method = "lm") + facet_wrap(~year) + labs(x = "Administrative jobs", y = "Two-party preferred (%)")
```

Increasing percentages of people employed in either industry, holding the other fixed, have increased support for the Liberal party in all elections. The interaction coefficient is close to zero in all elections (aside from 2010), meaning that effects are close to being independent. Electorates with few workers in both of these job types have been supportive of Labor, whereas having many workers in both lead to Liberal support, in all years.

```{r jobs1, fig.cap="Modelled two-party preferred vote (fill) for combinations of extractive and administrative related jobs."}
jobs_df <- data.frame(
  ManagerAdminClericalSales = rep(seq(-4,4, by = 0.01), times = 801),
  Extractive = rep(seq(-4,4, by = 0.01), each = 801),
  NoReligion = 0,
  CurrentlyStudying = 0,
  MedianAge = 0,
  OneParent_House = 0,
  Born_UK = 0,
  Born_SE_Europe = 0,
  Educ = 0,
  RentLoan = 0
)

jobs_df$z16 = predict(fit_ss_16, jobs_df) - fit_ss_16$coefficients[1]
jobs_df$z13 = predict(fit_ss_13, jobs_df) - fit_ss_13$coefficients[1]
jobs_df$z10 = predict(fit_ss_10, jobs_df) - fit_ss_10$coefficients[1]
jobs_df$z07 = predict(fit_ss_07, jobs_df) - fit_ss_07$coefficients[1]
jobs_df$z04 = predict(fit_ss_04, jobs_df) - fit_ss_04$coefficients[1]
jobs_df$z01 = predict(fit_ss_01, jobs_df) - fit_ss_01$coefficients[1]

Extractive_Office_16 <- jobs_df %>% ggplot(aes(x=Extractive, y=ManagerAdminClericalSales)) +
  geom_raster(aes(fill = z16)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2016") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Extractive,y=ManagerAdminClericalSales), data = data_mod %>% filter(year == "2016"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z16), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z16)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

Extractive_Office_13 <- jobs_df %>% ggplot(aes(x=Extractive, y=ManagerAdminClericalSales)) +
  geom_raster(aes(fill = z13)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2013") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Extractive,y=ManagerAdminClericalSales), data = data_mod %>% filter(year == "2013"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z13), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z13)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

Extractive_Office_10 <- jobs_df %>% ggplot(aes(x=Extractive, y=ManagerAdminClericalSales)) +
  geom_raster(aes(fill = z10)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2010") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Extractive,y=ManagerAdminClericalSales), data = data_mod %>% filter(year == "2010"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z10), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z10)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

Extractive_Office_07 <- jobs_df %>% ggplot(aes(x=Extractive, y=ManagerAdminClericalSales)) +
  geom_raster(aes(fill = z07)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2007") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Extractive,y=ManagerAdminClericalSales), data = data_mod %>% filter(year == "2007"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z07), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z07)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

Extractive_Office_04 <- jobs_df %>% ggplot(aes(x=Extractive, y=ManagerAdminClericalSales)) +
  geom_raster(aes(fill = z04)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2004") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Extractive,y=ManagerAdminClericalSales), data = data_mod %>% filter(year == "2004"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z04), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z04)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

Extractive_Office_01 <- jobs_df %>% ggplot(aes(x=Extractive, y=ManagerAdminClericalSales)) +
  geom_raster(aes(fill = z01)) + 
  labs(x = "", y = "", fill = "Marginal effect on two-party preferred (%)", title = "2001") +
  theme_bw() + 
  theme(plot.title = element_text(face = "bold", size = 10, hjust = 0.5)) + geom_point(aes(x=Extractive,y=ManagerAdminClericalSales), data = data_mod %>% filter(year == "2001"), alpha = 0.5) +  
  scale_fill_gradientn(colours = c("#ff0000", "#ff6666", "#ff9999", "#ffcccc", "white", "#cce6ff", "#3399ff", "#3385ff", "#3366ff"), 
                       values = scales::rescale(c(min(jobs_df$z01), -12, -6, -3, 
                                                  0, 3, 6, 12, max(jobs_df$z01)))) +  
  guides(fill = FALSE) +
  lims(x = c(-1,3.6), y = c(-3.9, 3.0)) + coord_fixed(expand=FALSE, ratio = 4.6/6.9)

grid.arrange(Extractive_Office_01, Extractive_Office_04, Extractive_Office_07, Extractive_Office_10, Extractive_Office_13, Extractive_Office_16, 
             nrow = 2, 
             bottom = textGrob("Extractive jobs", gp = gpar(cex = 0.8)), 
             left = textGrob("Administrative jobs", gp = gpar(cex = 0.8), rot = 90))

```

```{r jobs_scale, out.width="50%"}
## TPP scale
TPP_scale <- readPNG("figures/TPP_scale.png")
 grid.raster(TPP_scale)
```

### Administrative Jobs and Education

Over all years we see that the combination of above-average proportions of administrative jobs and low education levels support for the Liberal party. Increasing education levels has always increased support for Labor amongst these same areas with above-average adminstrative jobs. Whilst we see that the support predicted for electorates high education levels, with few adminstrative jobs has transitioned from Liberal to Labor over the years, no electorates are ever observed in this region (see appendix F). 

## Diagnostics

### Residuals

```{r augment}
aug_all <- bind_rows(augment(fit_ss_01) %>% mutate(year = "2001"), 
                     augment(fit_ss_04) %>% mutate(year = "2004"), 
                     augment(fit_ss_07) %>% mutate(year = "2007"), 
                     augment(fit_ss_10) %>% mutate(year = "2010"), 
                     augment(fit_ss_13) %>% mutate(year = "2013"), 
                     augment(fit_ss_16) %>% mutate(year = "2016"))
```

There are is little evidence of residual non-normality in the histograms and quantile-quantile plots, nor are there signs of residual heteroskedasticity (figures in \@ref(fig:alldiagnostics)). We produced plots of residuals against predictors in the model, which did not reveal any significant non-linear relationships. Doing the same for residuals against predictors excluded from the model, we do not find evidence of significant relationships between omitted socio-demographics and the residuals (see appendix D). All of this validates our assumptions about the distribution of the errors, and our model specification.

```{r alldiagnostics, fig.cap = "Diagnostics plots. Left are the histograms of the residuals in each year. Middle are the quantile-quantile plots. Right are the residuals against fitted values."}
# Histogram
d1 <- aug_all %>% 
  ggplot(aes(x = .resid)) + 
  geom_histogram() +
  facet_wrap(~year, nrow = 6) + 
  labs(x = "Residuals", y = "Count", title = "Residual histograms") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

# QQ plots
d2 <- aug_all %>% 
  ggplot(aes(sample = .resid)) + 
  geom_qq(alpha = 0.4) + geom_qq_line() + 
  facet_wrap(~year, nrow = 6) +
  labs(x = "Theoretical quantiles", y = "Sample residual quantiles", title = "Residual quantile-quantile plots") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

# Residuals vs fitted
d3 <- aug_all %>% 
  ggplot(aes(x=.fitted, y=.resid)) + 
  geom_point() + geom_smooth() +
  facet_wrap(~year, nrow = 6) + 
  labs(x = "Fitted values", y = "Residuals", title = "Residuals against fitted values") +
  theme(axis.title = element_text(size = 8), title = element_text(size = 8))

grid.arrange(d1,d2,d3, nrow = 1)
```

### Influence

Across the six elections, only two electorates have moderately large influence - Kalgoorlie (2001, 2004) and Sydney (2007, 2016) - as they have cook's distance greater than 0.2. The Kalgoorlie electorate supports the Liberal party  in these years ($TPP$ of around 55), but has an extremely low incidence of administrative jobs and a high incidence of atheism which are strong factors of Labor support. Sydney is a staunch Labor electorate, with $TPP$ ranging from 30.50% to 35.35% across the six years, but has very large student populations, low incidence of single parent households and high rental/loan prices. All of the observations with moderately large influence have hat values over 0.3, indicating that these also have unusual socio-demographic compositions.

The most influential electorate is Kalgoorlie in 2001, with cook distance of 0.31. As this is not particularly high, it does not appear that there are any outliers that have high influence on the model, and hence no observations should be removed. 

### Goodness-of-fit

The election models have adjusted R-squared between $[0.67, 0.77]$, indicating that socio-demographics are able to explain most of the variation in two-party preference.

```{r modelfit, fig.cap = "Fitted versus actual two-party preferred vote in each election"}
aug_all %>% 
  ggplot(aes(x=.fitted, y=Perc_LNP)) + 
  geom_abline(col = "blue", alpha = 0.5, size = 1) + 
  geom_point() + 
  facet_wrap(~year) +
  labs(x = "Fitted two-party preferred (%)", y = "Actual two-party preferred (%)") +
  theme_bw() + 
  theme(axis.title = element_text(size = 12))
```

\begin{table}[!htbp] \centering 
\small
\begin{tabular}{@{\extracolsep{5pt}}lcccccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{6}{c}{\textit{Dependent variable:}} \\ 
\cline{2-7} 
\\[-1.8ex] & \multicolumn{6}{c}{Two-party preferred vote (percentage point)} \\ 
\\[-1.8ex] & (2001) & (2004) & (2007) & (2010) & (2013) & (2016)\\ 
\hline \\[-1.8ex] 
R$^{2}$ & 0.777 & 0.782 & 0.793 & 0.730 & 0.752 & 0.701 \\ 
Adjusted R$^{2}$ & 0.753 & 0.759 & 0.772 & 0.702 & 0.726 & 0.670 \\ 
\hline 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

## A typical electorate

Based on the most recent (2016) election, we construct a hypothetical electorate that would be most likely to support each party.

\begin{table}[!htbp] \centering 
\normalsize
\begin{tabular}{@{\extracolsep{5pt}}lcccccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{2}{c}{\textit{A typical electorate in 2016:}} \\ 
\cline{2-3}
\\[-1.8ex] & \bf{Labor} & \bf{Liberal} \\ 
\hline \\[-1.8ex] 
\bf{Age} & Young & Old \\ 
\bf{Atheists} & Many & Few \\
\bf{Immigrants} & Many & Few \\
\bf{Education} & High & Low \\
\bf{Student population} & Low & High \\
\bf{Rent and loan payments} & Low & High \\
\bf{Extractive workers} & Few & Many \\
\bf{Administrative workers} & Few & Many \\
\bf{Single parent households} & Many & Few \\
\hline 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}